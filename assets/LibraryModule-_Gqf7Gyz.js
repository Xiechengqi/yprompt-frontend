import{d as K,E as re,r as h,B as W,e as n,w as H,f as e,h as _,t as l,L as $,F as P,y as N,s as r,o as ce,l as X,_ as ne,a as pe,i as U,v as J,Y as le,m as he,R as ae,n as oe,D as ie,Z as xe,M as fe,g as Q,j as A,$ as ye,p as be,b as we,u as ke,A as de,a0 as _e}from"./index-FUvL6nQC.js";import{c as me,_ as $e}from"./SavePromptDialog.vue_vue_type_script_setup_true_lang-BQATbsYD.js";class O{static getApiBaseUrl(){return""}static getAuthHeaders(){const f=localStorage.getItem("yprompt_token");if(!f)throw new Error("请先登录");return{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}}static async getVersionList(f,b=1,y=20,m){const p=new URLSearchParams({page:b.toString(),limit:y.toString()});return m&&p.append("tag",m),(await fetch(`${this.getApiBaseUrl()}/api/versions/${f}/versions?${p}`,{headers:this.getAuthHeaders()})).json()}static async getVersionDetail(f,b){return(await fetch(`${this.getApiBaseUrl()}/api/versions/${f}/versions/${b}`,{headers:this.getAuthHeaders()})).json()}static async createVersion(f,b){return(await fetch(`${this.getApiBaseUrl()}/api/versions/${f}`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(b)})).json()}static async rollbackToVersion(f,b,y){return(await fetch(`${this.getApiBaseUrl()}/api/versions/${f}/versions/${b}/rollback`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(y||{})})).json()}static async updateVersionTag(f,b,y){return(await fetch(`${this.getApiBaseUrl()}/api/versions/${f}/versions/${b}/tag`,{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify({version_tag:y})})).json()}static async deleteVersion(f,b){const y=await fetch(`${this.getApiBaseUrl()}/api/versions/${f}/versions/${b}`,{method:"DELETE",headers:this.getAuthHeaders()});if(!y.ok)throw new Error(`HTTP ${y.status}`);return y.json()}}const Ce={class:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col"},je={class:"flex items-center justify-between p-6 border-b"},Me={class:"flex-1 overflow-y-auto p-6"},ze={key:0,class:"flex items-center justify-center h-32"},Be={key:1,class:"space-y-6"},Ve={class:"text-lg font-semibold text-gray-900 mb-4"},Se={class:"grid grid-cols-2 gap-4 text-sm"},Le={class:"text-gray-900"},Te={class:"text-gray-900"},Ee={class:"text-gray-900"},He={class:"text-gray-900"},Ae={class:"border-t pt-6"},De={class:"text-sm text-gray-700"},Ie={key:0,class:"mt-3 p-3 bg-gray-50 rounded text-sm text-gray-700 whitespace-pre-wrap"},Pe={class:"border-t pt-6"},Ue={class:"grid grid-cols-3 gap-4 text-sm"},Ne={class:"text-gray-900"},Re={class:"text-gray-900"},Oe={class:"text-gray-900"},Ke={key:0,class:"border-t pt-6"},Fe={key:0,class:"mb-4"},Je={class:"bg-blue-50 border border-blue-200 rounded-lg p-3 max-h-48 overflow-y-auto"},We={class:"text-sm text-gray-800 whitespace-pre-wrap font-mono"},qe={key:1,class:"mb-4"},Ye={class:"bg-green-50 border border-green-200 rounded-lg p-3 max-h-48 overflow-y-auto"},Ze={class:"text-sm text-gray-800 whitespace-pre-wrap font-mono"},Ge={class:"border-t pt-6"},Qe={class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},Xe={class:"bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto"},et={class:"text-sm text-gray-800 whitespace-pre-wrap font-mono"},tt={key:1,class:"border-t pt-6"},st={class:"flex flex-wrap gap-2"},ot={class:"flex justify-end space-x-3 p-6 border-t bg-gray-50"},ge=K({__name:"VersionDetailModal",props:{version:{},promptId:{}},emits:["close","rollback"],setup(D,{emit:f}){const b=D,y=f,m=re(),p=h(null),z=h(!1),w=async()=>{if(b.version)try{z.value=!0;const u=await O.getVersionDetail(b.promptId,b.version.id);if(u.code===200)p.value=u.data;else throw new Error(u.message||"加载失败")}catch(u){console.error("加载版本详情失败:",u),m.error(`加载失败: ${u.message}`)}finally{z.value=!1}},B=()=>{p.value&&y("rollback",p.value)},C=u=>({manual:"手动创建",auto:"自动保存",rollback:"回滚创建",import:"导入创建"})[u]||u,T=u=>({major:"主要更新",minor:"次要更新",patch:"修订更新"})[u]||u,V=u=>new Date(u).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),j=u=>u<1024?`${u}B`:u<1024*1024?`${(u/1024).toFixed(1)}KB`:`${(u/(1024*1024)).toFixed(1)}MB`,g=u=>{try{const s=JSON.parse(u);return Array.isArray(s)?s.map((o,a)=>`[${a+1}] ${o.role}: ${o.content}`).join(`

`):u}catch{return u}};return W(()=>b.version,u=>{u&&w()},{immediate:!0}),(u,s)=>(r(),n("div",{class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",onClick:s[2]||(s[2]=H(o=>u.$emit("close"),["self"]))},[e("div",Ce,[e("div",je,[s[4]||(s[4]=e("h2",{class:"text-xl font-bold text-gray-900"},"版本详情",-1)),e("button",{onClick:s[0]||(s[0]=o=>u.$emit("close")),class:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"关闭"},[...s[3]||(s[3]=[e("span",{class:"text-xl"},"✕",-1)])])]),e("div",Me,[z.value?(r(),n("div",ze,[...s[5]||(s[5]=[e("div",{class:"flex items-center gap-2 text-gray-500"},[e("div",{class:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e("span",null,"加载中...")],-1)])])):p.value?(r(),n("div",Be,[e("div",null,[e("h3",Ve,"v"+l(p.value.version_number),1),e("div",Se,[e("div",null,[s[6]||(s[6]=e("span",{class:"text-gray-600"},"创建时间：",-1)),e("span",Le,l(V(p.value.create_time)),1)]),e("div",null,[s[7]||(s[7]=e("span",{class:"text-gray-600"},"创建者：",-1)),e("span",Te,l(p.value.author_name),1)]),e("div",null,[s[8]||(s[8]=e("span",{class:"text-gray-600"},"版本类型：",-1)),e("span",Ee,l(C(p.value.version_type)),1)]),e("div",null,[s[9]||(s[9]=e("span",{class:"text-gray-600"},"变更类型：",-1)),e("span",He,l(T(p.value.change_type)),1)])])]),e("div",Ae,[s[10]||(s[10]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),$(" 变更说明 ")],-1)),e("p",De,l(p.value.change_summary||"无"),1),p.value.change_log?(r(),n("div",Ie,l(p.value.change_log),1)):_("",!0)]),e("div",Pe,[s[14]||(s[14]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})]),$(" 统计信息 ")],-1)),e("div",Ue,[e("div",null,[s[11]||(s[11]=e("span",{class:"text-gray-600"},"内容大小：",-1)),e("span",Ne,l(j(p.value.content_size)),1)]),e("div",null,[s[12]||(s[12]=e("span",{class:"text-gray-600"},"使用次数：",-1)),e("span",Re,l(p.value.use_count)+" 次",1)]),e("div",null,[s[13]||(s[13]=e("span",{class:"text-gray-600"},"回滚次数：",-1)),e("span",Oe,l(p.value.rollback_count)+" 次",1)])])]),p.value.system_prompt||p.value.conversation_history?(r(),n("div",Ke,[s[17]||(s[17]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})]),$(" 用户提示词上下文 ")],-1)),p.value.system_prompt?(r(),n("div",Fe,[s[15]||(s[15]=e("h5",{class:"text-xs font-semibold text-gray-700 mb-2"},"系统提示词",-1)),e("div",Je,[e("pre",We,l(p.value.system_prompt),1)])])):_("",!0),p.value.conversation_history?(r(),n("div",qe,[s[16]||(s[16]=e("h5",{class:"text-xs font-semibold text-gray-700 mb-2"},"对话历史",-1)),e("div",Ye,[e("pre",Ze,l(g(p.value.conversation_history)),1)])])):_("",!0)])):_("",!0),e("div",Ge,[e("h4",Qe,[s[18]||(s[18]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),$(" "+l(p.value.system_prompt||p.value.conversation_history?"用户提示词内容":"提示词内容"),1)]),e("div",Xe,[e("pre",et,l(p.value.final_prompt||"无内容"),1)])]),p.value.tags&&p.value.tags.length>0?(r(),n("div",tt,[s[19]||(s[19]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})]),$(" 标签 ")],-1)),e("div",st,[(r(!0),n(P,null,N(p.value.tags,o=>(r(),n("span",{key:o,class:"px-3 py-1 bg-gray-100 text-gray-700 text-sm rounded-full"},l(o),1))),128))])])):_("",!0)])):_("",!0)]),e("div",ot,[e("button",{onClick:s[1]||(s[1]=o=>u.$emit("close")),class:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50"}," 关闭 "),e("button",{onClick:B,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600"}," 回滚到此版本 ")])])]))}}),rt={class:"h-full flex flex-col"},nt={key:0,class:"flex items-center justify-center h-32"},lt={key:1,class:"flex flex-col items-center justify-center h-32 text-center"},at={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 overflow-y-auto pr-2"},it=["onClick"],dt={class:"flex items-start justify-between mb-1.5"},ut={class:"flex-1 min-w-0"},ct={class:"flex items-center gap-2 mb-0.5"},pt={class:"text-sm font-semibold text-gray-900"},mt={class:"text-xs text-gray-500"},gt={class:"text-xs text-gray-600 line-clamp-1"},vt={class:"flex items-center text-xs text-gray-500 mb-1.5"},ht={class:"flex items-center gap-0.5"},xt={class:"truncate max-w-[80px]"},ft={class:"flex items-center gap-0.5"},yt={class:"flex items-center gap-1.5 pt-1.5 border-t border-gray-100"},bt=["onClick"],wt=["onClick"],kt=K({__name:"VersionHistoryContent",props:{promptId:{}},emits:["rollback"],setup(D,{emit:f}){const b=D,y=f,m=re(),p=h([]),z=h(!1),w=h(!1),B=h(null),C=async()=>{try{z.value=!0;const s=await O.getVersionList(b.promptId,1,10);if(s.code===200)p.value=s.data.items;else throw new Error(s.message||"加载失败")}catch(s){console.error("加载版本历史失败:",s),m.error(`加载失败: ${s.message}`)}finally{z.value=!1}},T=s=>{B.value=s,w.value=!0},V=async s=>{if(confirm(`确定要回滚到版本 v${s.version_number} 吗？`))try{const o=await O.rollbackToVersion(b.promptId,s.id,{change_summary:`回滚到版本 ${s.version_number}`});if(o.code===200)m.success(`成功回滚到版本 v${s.version_number}`),y("rollback",s.version_number),C(),w.value=!1;else throw new Error(o.message||"回滚失败")}catch(o){console.error("回滚失败:",o),m.error(`回滚失败: ${o.message}`)}},j=async s=>{if(confirm(`确定要删除版本 v${s.version_number} 吗？此操作不可恢复。`))try{const o=await O.deleteVersion(b.promptId,s.id);if(o.code===200)m.success(`版本 v${s.version_number} 已删除`),C();else throw new Error(o.message||"删除失败")}catch(o){console.error("删除版本失败:",o),m.error(`删除失败: ${o.message}`)}},g=s=>{const o=new Date(s),k=new Date().getTime()-o.getTime(),S=Math.floor(k/(1e3*60*60*24));return S===0?"今天 "+o.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):S===1?"昨天 "+o.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):S<7?`${S}天前`:o.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},u=s=>s<1024?`${s}B`:s<1024*1024?`${(s/1024).toFixed(1)}KB`:`${(s/(1024*1024)).toFixed(1)}MB`;return ce(()=>{C()}),(s,o)=>(r(),n("div",rt,[z.value?(r(),n("div",nt,[...o[1]||(o[1]=[e("div",{class:"flex items-center gap-2 text-gray-500"},[e("div",{class:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e("span",null,"加载中...")],-1)])])):p.value.length===0?(r(),n("div",lt,[...o[2]||(o[2]=[e("svg",{class:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"text-gray-600"},"暂无版本历史",-1)])])):(r(),n("div",at,[(r(!0),n(P,null,N(p.value,a=>(r(),n("div",{key:a.id,onClick:k=>T(a),class:"border border-gray-200 rounded-md p-2.5 hover:shadow-md transition-shadow cursor-pointer"},[e("div",dt,[e("div",ut,[e("div",ct,[e("h4",pt," v"+l(a.version_number),1),e("span",mt,l(g(a.create_time)),1)]),e("p",gt,l(a.change_summary||"优化提示词"),1)])]),e("div",vt,[e("span",ht,[o[3]||(o[3]=e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),e("span",xt,l(a.author_name),1)]),o[5]||(o[5]=e("span",{class:"mx-2 text-gray-300"},"•",-1)),e("span",ft,[o[4]||(o[4]=e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),$(" "+l(u(a.content_size)),1)])]),e("div",yt,[e("button",{onClick:H(k=>V(a),["stop"]),class:"px-2 py-1 text-xs bg-blue-50 hover:bg-blue-100 text-blue-600 rounded transition-colors flex items-center gap-1"},[...o[6]||(o[6]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",null,"回滚",-1)])],8,bt),e("button",{onClick:H(k=>j(a),["stop"]),class:"px-2 py-1 text-xs bg-red-50 hover:bg-red-100 text-red-600 rounded transition-colors flex items-center justify-center",title:"删除版本"},[...o[7]||(o[7]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,wt)])],8,it))),128))])),w.value?(r(),X(ge,{key:3,version:B.value,"prompt-id":s.promptId,onClose:o[0]||(o[0]=a=>w.value=!1),onRollback:V},null,8,["version","prompt-id"])):_("",!0)]))}}),_t=ne(kt,[["__scopeId","data-v-a52ad1b1"]]),$t={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4"},Ct={class:"prompt-detail-modal bg-white rounded-lg shadow-xl w-full h-[90vh] max-w-6xl mx-4 overflow-hidden flex flex-col"},jt={class:"flex items-start justify-between p-6 border-b bg-gray-50"},Mt={class:"flex-1 min-w-0"},zt={key:0,class:"space-y-3"},Bt={class:"flex items-center gap-4"},Vt={class:"flex-1 min-w-0"},St={class:"flex items-center gap-2 flex-shrink-0"},Lt=["disabled"],Tt={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Et={class:"flex items-center gap-3 px-3 py-2 bg-gray-50 rounded-lg border border-gray-200"},Ht={class:"flex items-center gap-1.5"},At={class:"flex gap-2"},Dt={class:"flex items-center cursor-pointer group"},It={class:"flex items-center cursor-pointer group"},Pt={class:"flex items-center cursor-pointer group"},Ut={class:"flex items-center gap-1.5 flex-1 min-w-0"},Nt={class:"flex items-center gap-1 flex-wrap flex-1 min-w-0"},Rt={class:"max-w-[80px] truncate"},Ot=["onClick"],Kt={key:1,class:"text-xs text-gray-400"},Ft={key:0,class:"px-3"},Jt={class:"flex items-center gap-2 p-2 bg-blue-50 border border-blue-200 rounded-lg"},Wt=["onKeydown"],qt={key:1},Yt={class:"flex items-center gap-4"},Zt={class:"flex-1 min-w-0"},Gt={class:"flex items-center gap-2"},Qt={class:"text-xl font-semibold text-gray-900 truncate"},Xt={key:0,class:"text-sm text-gray-600 mt-1 truncate"},es={class:"flex items-center gap-2 flex-shrink-0"},ts={key:0,class:"flex-1 overflow-hidden flex flex-col"},ss={key:0,class:"px-6 py-3 bg-gray-50 border-b"},os={class:"flex items-center flex-wrap gap-4 text-sm text-gray-600"},rs={class:"flex items-center gap-1"},ns={class:"flex items-center gap-1"},ls={class:"flex items-center gap-1"},as={class:"flex items-center gap-1"},is={class:"flex items-center gap-1"},ds={key:0,class:"w-4 h-4 text-yellow-500",fill:"currentColor",viewBox:"0 0 24 24"},us={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},cs={class:"flex items-center gap-2"},ps={class:"flex flex-wrap gap-1"},ms={key:0,class:"text-xs text-gray-500"},gs={class:"flex-1 overflow-hidden flex flex-col"},vs={class:"flex border-b"},hs=["onClick"],xs={class:"flex-1 overflow-y-auto p-6"},fs={key:0,class:"h-full"},ys={key:1,class:"h-full p-4 whitespace-pre-wrap text-sm text-gray-800 font-mono overflow-auto bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg border border-gray-200"},bs={key:1,class:"space-y-4"},ws={class:"space-y-3"},ks={class:"flex"},_s={class:"text-sm text-gray-900"},$s={class:"flex"},Cs={class:"text-sm text-gray-900"},js={class:"flex"},Ms={class:"text-sm text-gray-900"},zs={class:"flex"},Bs={class:"text-sm text-gray-900"},Vs={class:"flex"},Ss={class:"text-sm text-gray-900"},Ls={class:"flex"},Ts={class:"text-sm text-gray-900"},Es={class:"flex"},Hs={class:"text-sm text-gray-900"},As={class:"pt-3 border-t border-gray-200"},Ds={class:"text-sm text-gray-900"},Is={key:0,class:"p-3 bg-gray-50 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"},Ps={key:1,class:"text-gray-400 italic"},Us={class:"pt-3 border-t border-gray-200"},Ns={class:"text-sm text-gray-900"},Rs={key:0,class:"p-3 bg-gray-50 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"},Os={key:1,class:"text-gray-400 italic"},Ks={key:2,class:"h-full"},Fs=K({__name:"PromptDetailModal",props:{prompt:{}},emits:["close","edit","optimize","rollback"],setup(D,{expose:f,emit:b}){const y="",m=D,p=b,z=pe(()=>!!m.prompt),w=h("content"),B=h(!1),C=h(""),T=h(""),V=h(""),j=h("system"),g=h(!1),u=h([]),s=h(""),o=h(!1),a=h(),k=h(!1),S=h(!1),E=[{key:"content",label:"提示词内容"},{key:"info",label:"基本信息"},{key:"versions",label:"版本历史"}],F=()=>{B.value=!1,p("close"),w.value="content"},I=()=>{m.prompt&&(C.value=m.prompt.final_prompt,T.value=m.prompt.title,V.value=m.prompt.description||"",j.value=m.prompt.prompt_type||"system",g.value=!!m.prompt.is_public,u.value=[...m.prompt.tags],B.value=!0)},q=()=>{B.value=!1,C.value="",T.value="",V.value="",j.value="system",g.value=!1,u.value=[],s.value="",o.value=!1},Y=()=>{const d=s.value.trim();if(d){if(u.value.length>=5){alert("最多只能添加5个标签");return}if(u.value.includes(d)){alert("标签已存在"),s.value="";return}if(d.length>8){alert("标签最多8个字符");return}u.value.push(d),s.value="",o.value=!1}},ee=d=>{u.value.splice(d,1)};W(o,async d=>{var t;d&&(await ie(),(t=a.value)==null||t.focus())});const te=async()=>{if(m.prompt)try{k.value=!0;const d=localStorage.getItem("yprompt_token");if(!d)throw new Error("请先登录");const t=await fetch(`${y}/api/prompts/${m.prompt.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify({title:T.value.trim(),description:V.value.trim(),final_prompt:C.value,prompt_type:j.value,is_public:g.value?1:0,tags:u.value})});if(!t.ok){let x="保存失败";try{x=(await t.json()).message||x}catch{x=`保存失败: ${t.status} ${t.statusText}`}throw new Error(x)}const R=await t.json();if(R.code===200)alert("保存成功"),B.value=!1,m.prompt&&(m.prompt.title=T.value.trim(),m.prompt.description=V.value.trim(),m.prompt.final_prompt=C.value,m.prompt.prompt_type=j.value,m.prompt.is_public=g.value?1:0,m.prompt.tags=u.value),p("edit",m.prompt);else throw new Error(R.message||"保存失败")}catch(d){console.error("保存失败:",d),alert(`保存失败: ${d.message}`)}finally{k.value=!1}},Z=async()=>{if(m.prompt)try{await me(m.prompt.final_prompt),alert("提示词已复制到剪贴板")}catch(d){console.error("复制失败:",d),alert("复制失败")}},G=d=>new Date(d).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),se=()=>{S.value=!0};return W(()=>m.prompt,()=>{m.prompt&&S.value&&ie(()=>{I(),S.value=!1})}),f({startEdit:se}),(d,t)=>{var R,x,i,M;return z.value?(r(),n("div",$t,[e("div",Ct,[e("div",jt,[e("div",Mt,[B.value?(r(),n("div",zt,[e("div",Bt,[e("div",Vt,[U(e("input",{"onUpdate:modelValue":t[0]||(t[0]=v=>T.value=v),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none text-xl font-semibold text-gray-900",placeholder:"请输入标题"},null,512),[[J,T.value]])]),e("div",St,[e("button",{onClick:q,class:"px-3 py-1.5 text-sm bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors flex items-center gap-1"},[...t[12]||(t[12]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),$(" 取消 ",-1)])]),e("button",{onClick:te,disabled:k.value,class:"px-3 py-1.5 text-sm bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors flex items-center gap-1 disabled:opacity-50"},[k.value?_("",!0):(r(),n("svg",Tt,[...t[13]||(t[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"},null,-1)])])),$(" "+l(k.value?"保存中...":"保存"),1)],8,Lt)])]),U(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=v=>V.value=v),class:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none text-sm text-gray-700 resize-none",rows:"2",placeholder:"请输入描述（可选）"},null,512),[[J,V.value]]),e("div",Et,[e("div",Ht,[t[16]||(t[16]=e("span",{class:"text-xs font-medium text-gray-600"},"类型",-1)),e("div",At,[e("label",Dt,[U(e("input",{"onUpdate:modelValue":t[2]||(t[2]=v=>j.value=v),type:"radio",value:"system",class:"w-3.5 h-3.5 text-purple-600 border-gray-300 focus:ring-purple-500 focus:ring-1"},null,512),[[le,j.value]]),t[14]||(t[14]=e("span",{class:"ml-1 text-xs text-gray-700 group-hover:text-purple-600"},"系统",-1))]),e("label",It,[U(e("input",{"onUpdate:modelValue":t[3]||(t[3]=v=>j.value=v),type:"radio",value:"user",class:"w-3.5 h-3.5 text-blue-600 border-gray-300 focus:ring-blue-500 focus:ring-1"},null,512),[[le,j.value]]),t[15]||(t[15]=e("span",{class:"ml-1 text-xs text-gray-700 group-hover:text-blue-600"},"用户",-1))])])]),t[20]||(t[20]=e("div",{class:"w-px h-4 bg-gray-300"},null,-1)),e("label",Pt,[U(e("input",{"onUpdate:modelValue":t[4]||(t[4]=v=>g.value=v),type:"checkbox",class:"w-3.5 h-3.5 text-green-600 border-gray-300 rounded focus:ring-green-500 focus:ring-1"},null,512),[[he,g.value]]),t[17]||(t[17]=e("span",{class:"ml-1 text-xs text-gray-700 group-hover:text-green-600"},"公开",-1))]),t[21]||(t[21]=e("div",{class:"w-px h-4 bg-gray-300"},null,-1)),e("div",Ut,[t[19]||(t[19]=e("span",{class:"text-xs font-medium text-gray-600 flex-shrink-0"},"标签",-1)),e("div",Nt,[(r(!0),n(P,null,N(u.value,(v,c)=>(r(),n("span",{key:c,class:"inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-blue-100 text-blue-700 text-xs rounded hover:bg-blue-200 transition-colors"},[e("span",Rt,l(v),1),e("button",{onClick:L=>ee(c),class:"text-blue-600 hover:text-blue-800 font-bold text-sm leading-none",title:"移除标签"}," × ",8,Ot)]))),128)),u.value.length<5?(r(),n("button",{key:0,onClick:t[5]||(t[5]=v=>o.value=!o.value),class:"inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs rounded transition-colors",title:"添加标签"},[...t[18]||(t[18]=[e("span",null,"+",-1)])])):(r(),n("span",Kt,"(最多5个)"))])])]),o.value?(r(),n("div",Ft,[e("div",Jt,[U(e("input",{ref_key:"tagInputRef",ref:a,"onUpdate:modelValue":t[6]||(t[6]=v=>s.value=v),type:"text",placeholder:"输入标签名（最多8字）",maxlength:"8",class:"flex-1 px-2 py-1 border border-gray-300 rounded outline-none text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500",onKeydown:[ae(H(Y,["prevent"]),["enter"]),t[7]||(t[7]=ae(v=>o.value=!1,["esc"]))]},null,40,Wt),[[J,s.value]]),e("button",{onClick:Y,class:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded transition-colors"}," 添加 "),e("button",{onClick:t[8]||(t[8]=v=>{o.value=!1,s.value=""}),class:"px-3 py-1 bg-gray-300 hover:bg-gray-400 text-gray-700 text-sm rounded transition-colors"}," 取消 ")])])):_("",!0)])):(r(),n("div",qt,[e("div",Yt,[e("div",Zt,[e("div",Gt,[e("h2",Qt,l((R=d.prompt)==null?void 0:R.title),1),e("span",{class:oe([((x=d.prompt)==null?void 0:x.prompt_type)==="system"?"bg-purple-100 text-purple-700 border-purple-200":"bg-blue-100 text-blue-700 border-blue-200","px-2 py-0.5 text-xs font-medium rounded border flex-shrink-0"])},l(((i=d.prompt)==null?void 0:i.prompt_type)==="system"?"系统提示词":"用户提示词"),3)]),(M=d.prompt)!=null&&M.description?(r(),n("p",Xt,l(d.prompt.description),1)):_("",!0)]),e("div",es,[e("button",{onClick:Z,class:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors flex items-center gap-1"},[...t[22]||(t[22]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),$(" 复制 ",-1)])]),e("button",{onClick:I,"data-edit":"prompt-detail",class:"px-3 py-1.5 text-sm bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors flex items-center gap-1"},[...t[23]||(t[23]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),$(" 编辑 ",-1)])]),d.prompt?(r(),n("button",{key:0,onClick:t[9]||(t[9]=v=>d.$emit("optimize",d.prompt)),class:"px-3 py-1.5 text-sm bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors flex items-center gap-1"},[...t[24]||(t[24]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),$(" 优化 ",-1)])])):_("",!0)])])]))]),e("button",{onClick:F,class:"text-gray-400 hover:text-gray-600 ml-4"},[...t[25]||(t[25]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),d.prompt?(r(),n("div",ts,[B.value?_("",!0):(r(),n("div",ss,[e("div",os,[e("span",rs,[t[26]||(t[26]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),$(" "+l(d.prompt.is_public?"公开":"私有"),1)]),t[33]||(t[33]=e("span",{class:"w-px h-4 bg-gray-300"},null,-1)),e("span",ns,[t[27]||(t[27]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)),$(" "+l(d.prompt.view_count||0),1)]),e("span",ls,[t[28]||(t[28]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)),$(" "+l(d.prompt.use_count||0),1)]),e("span",as,[t[29]||(t[29]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),$(" v"+l(d.prompt.current_version||"1.0.0"),1)]),e("span",is,[d.prompt.is_favorite?(r(),n("svg",ds,[...t[30]||(t[30]=[e("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},null,-1)])])):(r(),n("svg",us,[...t[31]||(t[31]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"},null,-1)])])),$(" "+l(d.prompt.is_favorite?"已收藏":"未收藏"),1)]),t[34]||(t[34]=e("span",{class:"w-px h-4 bg-gray-300"},null,-1)),e("div",cs,[t[32]||(t[32]=e("span",null,"标签:",-1)),e("div",ps,[(r(!0),n(P,null,N(d.prompt.tags,v=>(r(),n("span",{key:v,class:"inline-block px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full"},l(v),1))),128)),d.prompt.tags.length===0?(r(),n("span",ms,"暂无标签")):_("",!0)])])])])),e("div",gs,[e("div",vs,[(r(),n(P,null,N(E,v=>e("button",{key:v.key,onClick:c=>w.value=v.key,class:oe(["flex-1 px-4 py-3 text-sm font-medium transition-colors",w.value===v.key?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"])},l(v.label),11,hs)),64))]),e("div",xs,[w.value==="content"?(r(),n("div",fs,[B.value?U((r(),n("textarea",{key:0,"onUpdate:modelValue":t[10]||(t[10]=v=>C.value=v),class:"w-full h-full p-4 outline-none resize-none text-sm text-gray-800 font-mono bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg border border-gray-200",placeholder:"请输入提示词内容..."},null,512)),[[J,C.value]]):(r(),n("pre",ys,l(d.prompt.final_prompt),1))])):_("",!0),w.value==="info"?(r(),n("div",bs,[e("div",null,[e("dl",ws,[e("div",ks,[t[35]||(t[35]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"标题:",-1)),e("dd",_s,l(d.prompt.title),1)]),e("div",$s,[t[36]||(t[36]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"描述:",-1)),e("dd",Cs,l(d.prompt.description||"暂无描述"),1)]),e("div",js,[t[37]||(t[37]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"语言:",-1)),e("dd",Ms,l(d.prompt.language==="zh"?"中文":"英文"),1)]),e("div",zs,[t[38]||(t[38]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"格式:",-1)),e("dd",Bs,l(d.prompt.format),1)]),e("div",Vs,[t[39]||(t[39]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"字符数:",-1)),e("dd",Ss,l(d.prompt.final_prompt.length),1)]),e("div",Ls,[t[40]||(t[40]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"创建时间:",-1)),e("dd",Ts,l(G(d.prompt.create_time)),1)]),e("div",Es,[t[41]||(t[41]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"更新时间:",-1)),e("dd",Hs,l(G(d.prompt.update_time)),1)]),d.prompt.prompt_type==="user"?(r(),n(P,{key:0},[e("div",As,[t[42]||(t[42]=e("dt",{class:"text-sm font-medium text-gray-600 mb-2"},"系统提示词:",-1)),e("dd",Ds,[d.prompt.system_prompt?(r(),n("pre",Is,l(d.prompt.system_prompt),1)):(r(),n("span",Ps,"未设置"))])]),e("div",Us,[t[43]||(t[43]=e("dt",{class:"text-sm font-medium text-gray-600 mb-2"},"对话上下文:",-1)),e("dd",Ns,[d.prompt.conversation_history?(r(),n("pre",Rs,l(d.prompt.conversation_history),1)):(r(),n("span",Os,"未设置"))])])],64)):_("",!0)])])])):_("",!0),w.value==="versions"?(r(),n("div",Ks,[d.prompt?(r(),X(_t,{key:0,"prompt-id":d.prompt.id,onRollback:t[11]||(t[11]=v=>p("rollback",v))},null,8,["prompt-id"])):_("",!0)])):_("",!0)])])])):_("",!0)])])):_("",!0)}}}),Js={class:"bg-white rounded-lg max-w-3xl w-full max-h-[85vh] overflow-hidden flex flex-col"},Ws={class:"flex items-center justify-between p-6 border-b"},qs={class:"text-sm text-gray-600 mt-1"},Ys={class:"flex-1 overflow-y-auto p-6"},Zs={key:0,class:"flex items-center justify-center h-32"},Gs={key:1,class:"flex flex-col items-center justify-center h-32 text-center"},Qs={key:2,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Xs=["onClick"],eo={class:"flex items-start justify-between mb-3"},to={class:"flex-1 min-w-0"},so={class:"flex items-center gap-2 mb-2"},oo={class:"text-base font-semibold text-gray-900"},ro={class:"text-xs text-gray-500"},no={class:"text-sm text-gray-700 line-clamp-2"},lo={class:"flex items-center justify-between text-xs text-gray-500 mb-3"},ao={class:"flex items-center gap-4"},io={class:"flex items-center gap-1"},uo={class:"flex items-center gap-1"},co={class:"flex items-center gap-2 pt-3 border-t border-gray-100"},po=["onClick"],mo=["onClick"],go=K({__name:"VersionHistoryPanel",props:{isOpen:{type:Boolean},promptId:{}},emits:["close","rollback"],setup(D,{emit:f}){const b=D,y=f,m=re(),p=h([]),z=h(!1),w=h(!1),B=h(null),C=async()=>{try{z.value=!0;const o=await O.getVersionList(b.promptId,1,10);if(o.code===200)p.value=o.data.items;else throw new Error(o.message||"加载失败")}catch(o){console.error("加载版本历史失败:",o),m.error(`加载失败: ${o.message}`)}finally{z.value=!1}},T=o=>{B.value=o,w.value=!0},V=async o=>{if(confirm(`确定要回滚到版本 v${o.version_number} 吗？`))try{const a=await O.rollbackToVersion(b.promptId,o.id,{change_summary:`回滚到版本 ${o.version_number}`});if(a.code===200)m.success(`成功回滚到版本 v${o.version_number}`),y("rollback",o.version_number),C(),g();else throw new Error(a.message||"回滚失败")}catch(a){console.error("回滚失败:",a),m.error(`回滚失败: ${a.message}`)}},j=async o=>{if(confirm(`确定要删除版本 v${o.version_number} 吗？此操作不可恢复。`))try{const a=await O.deleteVersion(b.promptId,o.id);if(a.code===200)m.success(`版本 v${o.version_number} 已删除`),C();else throw new Error(a.message||"删除失败")}catch(a){console.error("删除版本失败:",a),m.error(`删除失败: ${a.message}`)}},g=()=>{y("close")},u=o=>{const a=new Date(o),S=new Date().getTime()-a.getTime(),E=Math.floor(S/(1e3*60*60*24));return E===0?"今天 "+a.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):E===1?"昨天 "+a.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):E<7?`${E}天前`:a.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},s=o=>o<1024?`${o}B`:o<1024*1024?`${(o/1024).toFixed(1)}KB`:`${(o/(1024*1024)).toFixed(1)}MB`;return W(()=>b.isOpen,o=>{o&&C()}),(o,a)=>o.isOpen?(r(),n("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:H(g,["self"])},[e("div",Js,[e("div",Ws,[e("div",null,[a[1]||(a[1]=e("h2",{class:"text-xl font-bold text-gray-900 flex items-center gap-2"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),$(" 版本历史 ")],-1)),e("p",qs,"共 "+l(p.value.length)+" 个版本",1)]),e("button",{onClick:g,class:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"关闭"},[...a[2]||(a[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Ys,[z.value?(r(),n("div",Zs,[...a[3]||(a[3]=[e("div",{class:"flex items-center gap-2 text-gray-500"},[e("div",{class:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e("span",null,"加载中...")],-1)])])):p.value.length===0?(r(),n("div",Gs,[...a[4]||(a[4]=[e("svg",{class:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"text-gray-600"},"暂无版本历史",-1)])])):(r(),n("div",Qs,[(r(!0),n(P,null,N(p.value,k=>(r(),n("div",{key:k.id,onClick:S=>T(k),class:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer"},[e("div",eo,[e("div",to,[e("div",so,[e("h3",oo," v"+l(k.version_number),1),e("span",ro,l(u(k.create_time)),1)]),e("p",no,l(k.change_summary||"无变更说明"),1)])]),e("div",lo,[e("div",ao,[e("span",io,[a[5]||(a[5]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),$(" "+l(k.author_name),1)]),e("span",uo,[a[6]||(a[6]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),$(" "+l(s(k.content_size)),1)])])]),e("div",co,[e("button",{onClick:H(S=>V(k),["stop"]),class:"flex-1 px-3 py-1.5 text-sm bg-blue-100 hover:bg-blue-200 text-blue-700 rounded transition-colors flex items-center justify-center gap-1"},[...a[7]||(a[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),$(" 回滚到此版本 ",-1)])],8,po),e("button",{onClick:H(S=>j(k),["stop"]),class:"px-3 py-1.5 text-sm bg-red-100 hover:bg-red-200 text-red-700 rounded transition-colors flex items-center justify-center",title:"删除版本"},[...a[8]||(a[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,mo)])],8,Xs))),128))]))])]),w.value?(r(),X(ge,{key:0,version:B.value,"prompt-id":o.promptId,onClose:a[0]||(a[0]=k=>w.value=!1),onRollback:V},null,8,["version","prompt-id"])):_("",!0)])):_("",!0)}}),vo=ne(go,[["__scopeId","data-v-06688c15"]]),ho={class:"h-full flex flex-col"},xo={class:"flex-1 overflow-y-auto p-4"},fo={key:0,class:"flex items-center justify-center h-32"},yo={key:1,class:"flex flex-col items-center justify-center h-64 text-center"},bo={class:"text-lg font-semibold text-gray-800 mb-2"},wo={class:"text-gray-600 mb-4"},ko={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},_o=["onClick"],$o={class:"flex items-start justify-between gap-3 mb-3"},Co={class:"flex-1 min-w-0"},jo={class:"text-base font-medium text-gray-900 truncate mb-1"},Mo={class:"text-sm text-gray-600 line-clamp-2 h-10"},zo={class:"text-sm text-gray-700 mb-3 p-3 bg-gradient-to-br from-gray-50 to-gray-100 rounded-md border border-gray-200"},Bo={class:"line-clamp-2 h-10 font-mono text-xs leading-relaxed"},Vo={key:0},So={key:1,class:"text-gray-400 italic"},Lo={class:"flex items-center justify-between pt-2 border-t border-gray-100"},To={class:"flex items-center gap-3 text-xs text-gray-500"},Eo={class:"flex items-center gap-1"},Ho={class:"flex items-center gap-1"},Ao={class:"flex items-center gap-1"},Do={class:"text-gray-400"},Io={class:"flex items-center gap-1"},Po=["onClick"],Uo={class:"relative group"},No=["onClick"],Ro=["onClick"],Oo=["onClick"],Ko=["onClick"],Fo=["onClick"],Jo={class:"mt-3 pt-2 border-t border-gray-100"},Wo={class:"flex flex-wrap gap-1"},qo={key:0,class:"text-xs text-gray-400"},Yo={key:3,class:"flex justify-center items-center gap-2 mt-6"},Zo=["disabled"],Go={class:"text-sm text-gray-600"},Qo=["disabled"],ue=10,Xo=K({__name:"PromptList",emits:["create-prompt"],setup(D,{expose:f,emit:b}){const y=xe("searchKeyword",h("")),m=we(),p=fe(),z="",w=h([]),B=h(!1),C=h(1),T=h(0),V=h(""),j=h("create_time"),g=h("0"),u=h([]);W(y,(x,i)=>{x!==i&&(C.value=1,I())},{immediate:!1});const s=x=>{y.value=x,C.value=1},o=h({}),a=h(!1),k=h(null),S=h(!1),E=h(null),F=pe(()=>Math.ceil(T.value/ue)),I=async()=>{try{B.value=!0;const x=localStorage.getItem("yprompt_token");if(!x)throw new Error("请先登录");const i=new URLSearchParams({page:C.value.toString(),limit:ue.toString(),keyword:y.value,tag:V.value,sort:j.value,is_favorite:g.value}),M=await fetch(`${z}/api/prompts/?${i}`,{headers:{Authorization:`Bearer ${x}`}});if(!M.ok){let c="加载失败";try{c=(await M.json()).message||c}catch{c=`加载失败: ${M.status} ${M.statusText}`}throw new Error(c)}const v=await M.json();if(v.code===200){w.value=v.data.items.map(L=>({...L,final_prompt:L.final_prompt||"",current_version:L.current_version||"1.0.0"})),T.value=v.data.total;const c=new Set;w.value.forEach(L=>{L.tags&&L.tags.forEach(ve=>c.add(ve))}),u.value=Array.from(c).sort()}else throw new Error(v.message||"加载失败")}catch(x){console.error("加载提示词列表失败:",x),alert(`加载失败: ${x.message}`)}finally{B.value=!1}},q=x=>{C.value=x,I()},Y=async x=>{try{const i=localStorage.getItem("yprompt_token");if(!i)return;const M=await fetch(`${z}/api/prompts/${x.id}`,{headers:{Authorization:`Bearer ${i}`}});if(!M.ok){let c="获取详情失败";try{c=(await M.json()).message||c}catch{c=`获取详情失败: ${M.status} ${M.statusText}`}throw new Error(c)}const v=await M.json();v.code===200&&(k.value=v.data,a.value=!0)}catch(i){console.error("获取提示词详情失败:",i),k.value=x,a.value=!0}},ee=x=>{k.value=x,a.value=!0,setTimeout(()=>{const i=document.querySelector('button[data-edit="prompt-detail"]');i&&i.click()},100)},te=x=>{const i=w.value.findIndex(M=>M.id===x.id);i!==-1&&(w.value[i]={...x}),a.value=!1},Z=x=>{p.setCurrentModule("optimize"),m.push(`/optimize/${x.id}`),a.value=!1},G=async x=>{try{await me(x.final_prompt),alert("提示词已复制到剪贴板")}catch(i){console.error("复制失败:",i),alert("复制失败")}},se=x=>{E.value=x,S.value=!0,o.value={}},d=()=>{I()},t=async x=>{if(confirm(`确定要删除提示词"${x.title}"吗？此操作不可恢复。`))try{const i=localStorage.getItem("yprompt_token");if(!i)return;const M=await fetch(`${z}/api/prompts/${x.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${i}`}});if(!M.ok){let c="删除失败";try{c=(await M.json()).message||c}catch{c=`删除失败: ${M.status} ${M.statusText}`}throw new Error(c)}const v=await M.json();if(v.code===200)alert("删除成功"),I();else throw new Error(v.message||"删除失败")}catch(i){console.error("删除提示词失败:",i),alert(`删除失败: ${i.message}`)}},R=x=>new Date(x).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return document.addEventListener("click",x=>{x.target.closest(".relative.group")||(o.value={})}),f({searchWithKeyword:s,loadPrompts:I}),ce(()=>{I()}),(x,i)=>{var v;const M=ye("router-link");return r(),n("div",ho,[e("div",xo,[B.value?(r(),n("div",fo,[...i[5]||(i[5]=[e("div",{class:"flex items-center gap-2 text-gray-500"},[e("div",{class:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e("span",null,"加载中...")],-1)])])):w.value.length===0?(r(),n("div",yo,[i[7]||(i[7]=e("svg",{class:"w-16 h-16 mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("h3",bo,l(A(y)||V.value?"没有找到匹配的提示词":"还没有保存的提示词"),1),e("p",wo,l(A(y)||V.value?"请尝试其他搜索条件":"去生成页面创建您的第一个提示词吧！"),1),Q(M,{to:"/generate",class:"inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},{default:be(()=>[...i[6]||(i[6]=[$(" 开始生成 ",-1)])]),_:1})])):(r(),n("div",ko,[(r(!0),n(P,null,N(w.value,c=>(r(),n("div",{key:c.id,class:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:L=>Y(c)},[e("div",$o,[e("div",Co,[e("h3",jo,l(c.title),1),e("p",Mo,l(c.description||"暂无描述"),1)]),e("span",{class:oe([c.prompt_type==="system"?"bg-purple-100 text-purple-700 border-purple-200":"bg-blue-100 text-blue-700 border-blue-200","px-2 py-0.5 text-xs font-medium rounded border flex-shrink-0"])},l(c.prompt_type==="system"?"系统":"用户"),3)]),e("div",zo,[e("div",Bo,[c.final_prompt?(r(),n("span",Vo,l(c.final_prompt.slice(0,150))+l(c.final_prompt.length>150?"...":""),1)):(r(),n("span",So," 暂无提示词内容 "))])]),e("div",Lo,[e("div",To,[e("span",Eo,[i[8]||(i[8]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)),$(" "+l(c.view_count||0),1)]),e("span",Ho,[i[9]||(i[9]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)),$(" "+l(c.use_count||0),1)]),e("span",Ao,[i[10]||(i[10]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),$(" v"+l(c.current_version||"1.0.0"),1)]),e("span",Do," • "+l(R(c.update_time||c.create_time)),1)]),e("div",Io,[e("button",{onClick:H(L=>G(c),["stop"]),class:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",title:"复制"},[...i[11]||(i[11]=[e("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])],8,Po),e("div",Uo,[e("button",{onClick:H(L=>o.value[c.id]=!o.value[c.id],["stop"]),class:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",title:"更多操作"},[...i[12]||(i[12]=[e("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})],-1)])],8,No),o.value[c.id]?(r(),n("div",{key:0,onClick:i[0]||(i[0]=H(()=>{},["stop"])),class:"absolute right-0 top-full mt-1 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-10"},[e("button",{onClick:H(L=>ee(c),["stop"]),class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 transition-colors flex items-center gap-2"},[...i[13]||(i[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),$(" 编辑 ",-1)])],8,Ro),e("button",{onClick:H(L=>Z(c),["stop"]),class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 transition-colors flex items-center gap-2"},[...i[14]||(i[14]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),$(" 优化 ",-1)])],8,Oo),e("button",{onClick:H(L=>se(c),["stop"]),class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 transition-colors flex items-center gap-2"},[...i[15]||(i[15]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),$(" 版本历史 ",-1)])],8,Ko),e("button",{onClick:H(L=>t(c),["stop"]),class:"w-full text-left px-3 py-2 text-sm hover:bg-red-50 text-red-600 transition-colors flex items-center gap-2"},[...i[16]||(i[16]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),$(" 删除 ",-1)])],8,Fo)])):_("",!0)])])]),e("div",Jo,[e("div",Wo,[(r(!0),n(P,null,N(c.tags||[],L=>(r(),n("span",{key:L,class:"inline-block px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-md"},l(L),1))),128)),!c.tags||c.tags.length===0?(r(),n("span",qo," 暂无标签 ")):_("",!0)])])],8,_o))),128))])),F.value>1?(r(),n("div",Yo,[e("button",{onClick:i[1]||(i[1]=c=>q(C.value-1)),disabled:C.value<=1,class:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," 上一页 ",8,Zo),e("span",Go," 第 "+l(C.value)+" 页，共 "+l(F.value)+" 页 ",1),e("button",{onClick:i[2]||(i[2]=c=>q(C.value+1)),disabled:C.value>=F.value,class:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," 下一页 ",8,Qo)])):_("",!0)]),a.value?(r(),X(Fs,{key:0,prompt:k.value,onClose:i[3]||(i[3]=c=>a.value=!1),onEdit:te,onOptimize:Z,onRollback:d},null,8,["prompt"])):_("",!0),Q(vo,{"is-open":S.value,"prompt-id":((v=E.value)==null?void 0:v.id)||0,onClose:i[4]||(i[4]=c=>S.value=!1),onRollback:d},null,8,["is-open","prompt-id"])])}}}),er=ne(Xo,[["__scopeId","data-v-80ab782b"]]),tr={class:"h-full flex flex-col overflow-hidden p-2"},sr={class:"bg-white rounded-lg shadow-sm p-6 mb-4 flex-shrink-0"},or={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6"},rr={key:0,class:"flex items-center gap-4"},nr={class:"relative"},lr=["src","alt"],ar={key:1,class:"w-14 h-14 rounded-full border-2 border-gray-300 bg-gray-100 flex items-center justify-center"},ir={class:"min-w-0"},dr={class:"text-xl font-bold text-gray-900"},ur={class:"flex items-center gap-3 text-sm text-gray-600 mt-1"},cr={key:0,class:"flex items-center gap-1"},pr={key:1,class:"flex items-center gap-1"},mr={key:1,class:"flex items-center gap-4"},gr={class:"flex flex-col sm:flex-row items-stretch sm:items-center gap-4"},vr={class:"relative"},hr={class:"flex items-center gap-3"},xr={class:"flex items-center gap-1 p-1 bg-gray-50 rounded-lg"},fr={class:"flex-1 bg-white rounded-lg shadow-sm overflow-hidden"},yr={key:0,class:"h-full flex flex-col"},br={key:1,class:"h-full flex items-center justify-center"},_r=K({__name:"LibraryModule",setup(D){const f=ke(),b="",y=h(!1),m=h(""),p=h(!1),z=h(""),w=h();let B=null;_e("searchKeyword",z);const C=()=>{B&&clearTimeout(B),B=setTimeout(()=>{w.value&&w.value.searchWithKeyword(z.value)},500)},T=async j=>{try{p.value=!0;const g=localStorage.getItem("yprompt_token");if(!g)throw new Error("请先登录");const s=await(await fetch(`${b}/api/prompts/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({title:j.title,description:j.description,final_prompt:j.content||m.value,language:"zh",format:"markdown",prompt_type:j.promptType,tags:j.tags,is_public:j.isPublic?1:0})})).json();if(s.code===200)alert("提示词创建成功！"),y.value=!1,m.value="",w.value&&await w.value.loadPrompts();else throw new Error(s.message||"创建失败")}catch(g){console.error("创建提示词失败:",g),alert(`创建失败: ${g.message}`)}finally{p.value=!1}},V=async()=>{await f.logout()};return(j,g)=>{var u,s,o,a,k,S;return r(),n("div",tr,[e("div",sr,[e("div",or,[A(f).isLoggedIn?(r(),n("div",rr,[e("div",nr,[(u=A(f).user)!=null&&u.avatar?(r(),n("img",{key:0,src:A(f).user.avatar,alt:(s=A(f).user)==null?void 0:s.name,class:"w-14 h-14 rounded-full border-2 border-blue-500 shadow-md object-cover"},null,8,lr)):(r(),n("div",ar,[...g[4]||(g[4]=[e("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)])])),g[5]||(g[5]=e("div",{class:"absolute bottom-0 right-0 w-4 h-4 bg-green-400 rounded-full border-2 border-white"},null,-1))]),e("div",ir,[e("h2",dr,l(((o=A(f).user)==null?void 0:o.name)||"用户"),1),e("div",ur,[(a=A(f).user)!=null&&a.email?(r(),n("span",cr,[g[6]||(g[6]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),$(" "+l(A(f).user.email),1)])):_("",!0),(k=A(f).user)!=null&&k.id?(r(),n("span",pr," ID: "+l((S=A(f).user)==null?void 0:S.id),1)):_("",!0)])])])):(r(),n("div",mr,[...g[7]||(g[7]=[de('<div class="w-14 h-14 rounded-full border-2 border-gray-300 bg-gray-100 flex items-center justify-center"><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg></div><div><h2 class="text-xl font-bold text-gray-900">未登录</h2><p class="text-sm text-gray-600">请先登录以管理您的提示词</p></div>',2)])])),e("div",gr,[e("div",vr,[g[8]||(g[8]=e("span",{class:"absolute left-3.5 top-2.5 text-gray-400"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),U(e("input",{"onUpdate:modelValue":g[0]||(g[0]=E=>z.value=E),type:"text",placeholder:"搜索提示词...",class:"w-80 pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg text-sm outline-none",onInput:C},null,544),[[J,z.value]])]),e("div",hr,[e("button",{onClick:g[1]||(g[1]=E=>y.value=!0),class:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center gap-2 whitespace-nowrap text-sm font-medium"},[...g[9]||(g[9]=[e("span",null,"新建提示词",-1)])]),e("div",xr,[A(f).isLoggedIn?(r(),n("button",{key:0,onClick:V,class:"px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md transition-colors font-medium",title:"登出"}," 登出 ")):_("",!0)])])])])]),e("div",fr,[A(f).isLoggedIn?(r(),n("div",yr,[Q(er,{ref_key:"promptListRef",ref:w,onCreatePrompt:g[2]||(g[2]=E=>y.value=!0)},null,512),Q($e,{"is-open":y.value,"prompt-content":m.value,"is-saving":p.value,onSave:T,onCancel:g[3]||(g[3]=E=>y.value=!1)},null,8,["is-open","prompt-content","is-saving"])])):(r(),n("div",br,[...g[10]||(g[10]=[de('<div class="text-center max-w-md px-6"><svg class="w-16 h-16 mb-4 text-gray-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg><h2 class="text-2xl font-bold text-gray-800 mb-2">请先登录</h2><p class="text-gray-600"> 登录后即可访问您的个人提示词库 </p></div>',1)])]))])])}}});export{_r as default};
