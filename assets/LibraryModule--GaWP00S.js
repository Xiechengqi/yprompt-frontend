const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CPHoan2D.js","assets/index-BQRFiOm5.css"])))=>i.map(i=>d[i]);
import{d as K,I as ee,r as g,D as q,b as i,w as L,e,f as j,t as d,Q as b,F as D,y as I,p as r,o as ge,i as te,_ as de,c as le,h as P,a2 as J,a8 as ce,k as he,a4 as ue,n as ae,H as pe,a9 as xe,aa as ye,g as Z,j as ie,ab as be,l as we,J as N,a as ke,u as _e,B as $e,ac as Ce}from"./index-CPHoan2D.js";import{c as ve,_ as je}from"./SavePromptDialog.vue_vue_type_script_setup_true_lang-CRhsdqRd.js";class R{static getApiBaseUrl(){return"https://api.prompt-ui.xiechengqi.top"}static getAuthHeaders(){const w=localStorage.getItem("yprompt_token");if(!w)throw new Error("请先登录");return{Authorization:`Bearer ${w}`,"Content-Type":"application/json"}}static async getVersionList(w,x=1,v=20,k){const n=new URLSearchParams({page:x.toString(),limit:v.toString()});return k&&n.append("tag",k),(await fetch(`${this.getApiBaseUrl()}/api/versions/${w}/versions?${n}`,{headers:this.getAuthHeaders()})).json()}static async getVersionDetail(w,x){return(await fetch(`${this.getApiBaseUrl()}/api/versions/${w}/versions/${x}`,{headers:this.getAuthHeaders()})).json()}static async createVersion(w,x){return(await fetch(`${this.getApiBaseUrl()}/api/versions/${w}`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(x)})).json()}static async rollbackToVersion(w,x,v){return(await fetch(`${this.getApiBaseUrl()}/api/versions/${w}/versions/${x}/rollback`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify(v||{})})).json()}static async updateVersionTag(w,x,v){return(await fetch(`${this.getApiBaseUrl()}/api/versions/${w}/versions/${x}/tag`,{method:"PUT",headers:this.getAuthHeaders(),body:JSON.stringify({version_tag:v})})).json()}static async deleteVersion(w,x){const v=await fetch(`${this.getApiBaseUrl()}/api/versions/${w}/versions/${x}`,{method:"DELETE",headers:this.getAuthHeaders()});if(!v.ok)throw new Error(`HTTP ${v.status}`);return v.json()}}const Me={class:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col"},Se={class:"flex items-center justify-between p-6 border-b"},Ve={class:"flex-1 overflow-y-auto p-6"},ze={key:0,class:"flex items-center justify-center h-32"},Be={key:1,class:"space-y-6"},Te={class:"text-lg font-semibold text-gray-900 mb-4"},Le={class:"grid grid-cols-2 gap-4 text-sm"},Ee={class:"text-gray-900"},Ae={class:"text-gray-900"},De={class:"text-gray-900"},He={class:"text-gray-900"},Pe={class:"border-t pt-6"},Ie={class:"text-sm text-gray-700"},Ne={key:0,class:"mt-3 p-3 bg-gray-50 rounded text-sm text-gray-700 whitespace-pre-wrap"},Re={class:"border-t pt-6"},Ue={class:"grid grid-cols-3 gap-4 text-sm"},Oe={class:"text-gray-900"},Ke={class:"text-gray-900"},Fe={class:"text-gray-900"},Je={key:0,class:"border-t pt-6"},qe={key:0,class:"mb-4"},We={class:"bg-blue-50 border border-blue-200 rounded-lg p-3 max-h-48 overflow-y-auto"},Qe={class:"text-sm text-gray-800 whitespace-pre-wrap font-mono"},Ge={key:1,class:"mb-4"},Xe={class:"bg-green-50 border border-green-200 rounded-lg p-3 max-h-48 overflow-y-auto"},Ye={class:"text-sm text-gray-800 whitespace-pre-wrap font-mono"},Ze={class:"border-t pt-6"},et={class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},tt={class:"bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto"},st={class:"text-sm text-gray-800 whitespace-pre-wrap font-mono"},ot={key:1,class:"border-t pt-6"},rt={class:"flex flex-wrap gap-2"},nt={class:"flex justify-end space-x-3 p-6 border-t bg-gray-50"},fe=K({__name:"VersionDetailModal",props:{version:{},promptId:{}},emits:["close","rollback"],setup(A,{emit:w}){const x=A,v=w,k=ee(),n=g(null),M=g(!1),S=async()=>{if(x.version)try{M.value=!0;const m=await R.getVersionDetail(x.promptId,x.version.id);if(m.code===200)n.value=m.data;else throw new Error(m.message||"加载失败")}catch(m){console.error("加载版本详情失败:",m),k.error(`加载失败: ${m.message}`)}finally{M.value=!1}},z=()=>{n.value&&v("rollback",n.value)},y=m=>({manual:"手动创建",auto:"自动保存",rollback:"回滚创建",import:"导入创建"})[m]||m,T=m=>({major:"主要更新",minor:"次要更新",patch:"修订更新"})[m]||m,_=m=>new Date(m).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),f=m=>m<1024?`${m}B`:m<1024*1024?`${(m/1024).toFixed(1)}KB`:`${(m/(1024*1024)).toFixed(1)}MB`,$=m=>{try{const s=JSON.parse(m);return Array.isArray(s)?s.map((o,l)=>`[${l+1}] ${o.role}: ${o.content}`).join(`

`):m}catch{return m}};return q(()=>x.version,m=>{m&&S()},{immediate:!0}),(m,s)=>(r(),i("div",{class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",onClick:s[2]||(s[2]=L(o=>m.$emit("close"),["self"]))},[e("div",Me,[e("div",Se,[s[4]||(s[4]=e("h2",{class:"text-xl font-bold text-gray-900"},"版本详情",-1)),e("button",{onClick:s[0]||(s[0]=o=>m.$emit("close")),class:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"关闭"},[...s[3]||(s[3]=[e("span",{class:"text-xl"},"✕",-1)])])]),e("div",Ve,[M.value?(r(),i("div",ze,[...s[5]||(s[5]=[e("div",{class:"flex items-center gap-2 text-gray-500"},[e("div",{class:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e("span",null,"加载中...")],-1)])])):n.value?(r(),i("div",Be,[e("div",null,[e("h3",Te,"v"+d(n.value.version_number),1),e("div",Le,[e("div",null,[s[6]||(s[6]=e("span",{class:"text-gray-600"},"创建时间：",-1)),e("span",Ee,d(_(n.value.create_time)),1)]),e("div",null,[s[7]||(s[7]=e("span",{class:"text-gray-600"},"创建者：",-1)),e("span",Ae,d(n.value.author_name),1)]),e("div",null,[s[8]||(s[8]=e("span",{class:"text-gray-600"},"版本类型：",-1)),e("span",De,d(y(n.value.version_type)),1)]),e("div",null,[s[9]||(s[9]=e("span",{class:"text-gray-600"},"变更类型：",-1)),e("span",He,d(T(n.value.change_type)),1)])])]),e("div",Pe,[s[10]||(s[10]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),b(" 变更说明 ")],-1)),e("p",Ie,d(n.value.change_summary||"无"),1),n.value.change_log?(r(),i("div",Ne,d(n.value.change_log),1)):j("",!0)]),e("div",Re,[s[14]||(s[14]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})]),b(" 统计信息 ")],-1)),e("div",Ue,[e("div",null,[s[11]||(s[11]=e("span",{class:"text-gray-600"},"内容大小：",-1)),e("span",Oe,d(f(n.value.content_size)),1)]),e("div",null,[s[12]||(s[12]=e("span",{class:"text-gray-600"},"使用次数：",-1)),e("span",Ke,d(n.value.use_count)+" 次",1)]),e("div",null,[s[13]||(s[13]=e("span",{class:"text-gray-600"},"回滚次数：",-1)),e("span",Fe,d(n.value.rollback_count)+" 次",1)])])]),n.value.system_prompt||n.value.conversation_history?(r(),i("div",Je,[s[17]||(s[17]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})]),b(" 用户提示词上下文 ")],-1)),n.value.system_prompt?(r(),i("div",qe,[s[15]||(s[15]=e("h5",{class:"text-xs font-semibold text-gray-700 mb-2"},"系统提示词",-1)),e("div",We,[e("pre",Qe,d(n.value.system_prompt),1)])])):j("",!0),n.value.conversation_history?(r(),i("div",Ge,[s[16]||(s[16]=e("h5",{class:"text-xs font-semibold text-gray-700 mb-2"},"对话历史",-1)),e("div",Xe,[e("pre",Ye,d($(n.value.conversation_history)),1)])])):j("",!0)])):j("",!0),e("div",Ze,[e("h4",et,[s[18]||(s[18]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),b(" "+d(n.value.system_prompt||n.value.conversation_history?"用户提示词内容":"提示词内容"),1)]),e("div",tt,[e("pre",st,d(n.value.final_prompt||"无内容"),1)])]),n.value.tags&&n.value.tags.length>0?(r(),i("div",ot,[s[19]||(s[19]=e("h4",{class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})]),b(" 标签 ")],-1)),e("div",rt,[(r(!0),i(D,null,I(n.value.tags,o=>(r(),i("span",{key:o,class:"px-3 py-1 bg-gray-100 text-gray-700 text-sm rounded-full"},d(o),1))),128))])])):j("",!0)])):j("",!0)]),e("div",nt,[e("button",{onClick:s[1]||(s[1]=o=>m.$emit("close")),class:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50"}," 关闭 "),e("button",{onClick:z,class:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600"}," 回滚到此版本 ")])])]))}}),lt={class:"h-full flex flex-col"},at={key:0,class:"flex items-center justify-center h-32"},it={key:1,class:"flex flex-col items-center justify-center h-32 text-center"},dt={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 overflow-y-auto pr-2"},ct=["onClick"],ut={class:"flex items-start justify-between mb-1.5"},pt={class:"flex-1 min-w-0"},mt={class:"flex items-center gap-2 mb-0.5"},gt={class:"text-sm font-semibold text-gray-900"},vt={class:"text-xs text-gray-500"},ft={class:"text-xs text-gray-600 line-clamp-1"},ht={class:"flex items-center text-xs text-gray-500 mb-1.5"},xt={class:"flex items-center gap-0.5"},yt={class:"truncate max-w-[80px]"},bt={class:"flex items-center gap-0.5"},wt={class:"flex items-center gap-1.5 pt-1.5 border-t border-gray-100"},kt=["onClick"],_t=["onClick"],$t=K({__name:"VersionHistoryContent",props:{promptId:{}},emits:["rollback"],setup(A,{emit:w}){const x=A,v=w,k=ee(),n=g([]),M=g(!1),S=g(!1),z=g(null),y=async()=>{try{M.value=!0;const s=await R.getVersionList(x.promptId,1,10);if(s.code===200)n.value=s.data.items;else throw new Error(s.message||"加载失败")}catch(s){console.error("加载版本历史失败:",s),k.error(`加载失败: ${s.message}`)}finally{M.value=!1}},T=s=>{z.value=s,S.value=!0},_=async s=>{if(confirm(`确定要回滚到版本 v${s.version_number} 吗？`))try{const o=await R.rollbackToVersion(x.promptId,s.id,{change_summary:`回滚到版本 ${s.version_number}`});if(o.code===200)k.success(`成功回滚到版本 v${s.version_number}`),v("rollback",s.version_number),y(),S.value=!1;else throw new Error(o.message||"回滚失败")}catch(o){console.error("回滚失败:",o),k.error(`回滚失败: ${o.message}`)}},f=async s=>{if(confirm(`确定要删除版本 v${s.version_number} 吗？此操作不可恢复。`))try{const o=await R.deleteVersion(x.promptId,s.id);if(o.code===200)k.success(`版本 v${s.version_number} 已删除`),y();else throw new Error(o.message||"删除失败")}catch(o){console.error("删除版本失败:",o),k.error(`删除失败: ${o.message}`)}},$=s=>{const o=new Date(s),C=new Date().getTime()-o.getTime(),B=Math.floor(C/(1e3*60*60*24));return B===0?"今天 "+o.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):B===1?"昨天 "+o.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):B<7?`${B}天前`:o.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},m=s=>s<1024?`${s}B`:s<1024*1024?`${(s/1024).toFixed(1)}KB`:`${(s/(1024*1024)).toFixed(1)}MB`;return ge(()=>{y()}),(s,o)=>(r(),i("div",lt,[M.value?(r(),i("div",at,[...o[1]||(o[1]=[e("div",{class:"flex items-center gap-2 text-gray-500"},[e("div",{class:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e("span",null,"加载中...")],-1)])])):n.value.length===0?(r(),i("div",it,[...o[2]||(o[2]=[e("svg",{class:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"text-gray-600"},"暂无版本历史",-1)])])):(r(),i("div",dt,[(r(!0),i(D,null,I(n.value,l=>(r(),i("div",{key:l.id,onClick:C=>T(l),class:"border border-gray-200 rounded-md p-2.5 hover:shadow-md transition-shadow cursor-pointer"},[e("div",ut,[e("div",pt,[e("div",mt,[e("h4",gt," v"+d(l.version_number),1),e("span",vt,d($(l.create_time)),1)]),e("p",ft,d(l.change_summary||"优化提示词"),1)])]),e("div",ht,[e("span",xt,[o[3]||(o[3]=e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),e("span",yt,d(l.author_name),1)]),o[5]||(o[5]=e("span",{class:"mx-2 text-gray-300"},"•",-1)),e("span",bt,[o[4]||(o[4]=e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),b(" "+d(m(l.content_size)),1)])]),e("div",wt,[e("button",{onClick:L(C=>_(l),["stop"]),class:"px-2 py-1 text-xs bg-blue-50 hover:bg-blue-100 text-blue-600 rounded transition-colors flex items-center gap-1"},[...o[6]||(o[6]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),e("span",null,"回滚",-1)])],8,kt),e("button",{onClick:L(C=>f(l),["stop"]),class:"px-2 py-1 text-xs bg-red-50 hover:bg-red-100 text-red-600 rounded transition-colors flex items-center justify-center",title:"删除版本"},[...o[7]||(o[7]=[e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,_t)])],8,ct))),128))])),S.value?(r(),te(fe,{key:3,version:z.value,"prompt-id":s.promptId,onClose:o[0]||(o[0]=l=>S.value=!1),onRollback:_},null,8,["version","prompt-id"])):j("",!0)]))}}),Ct=de($t,[["__scopeId","data-v-a52ad1b1"]]),jt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4"},Mt={class:"prompt-detail-modal bg-white rounded-lg shadow-xl w-full h-[90vh] max-w-6xl mx-4 overflow-hidden flex flex-col"},St={class:"flex items-start justify-between p-6 border-b bg-gray-50"},Vt={class:"flex-1 min-w-0"},zt={key:0,class:"space-y-3"},Bt={class:"flex items-center gap-4"},Tt={class:"flex-1 min-w-0"},Lt={class:"flex items-center gap-2 flex-shrink-0"},Et=["disabled"],At={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Dt={class:"flex items-center gap-3 px-3 py-2 bg-gray-50 rounded-lg border border-gray-200"},Ht={class:"flex items-center gap-1.5"},Pt={class:"flex gap-2"},It={class:"flex items-center cursor-pointer group"},Nt={class:"flex items-center cursor-pointer group"},Rt={class:"flex items-center cursor-pointer group"},Ut={class:"flex items-center gap-1.5 flex-1 min-w-0"},Ot={class:"flex items-center gap-1 flex-wrap flex-1 min-w-0"},Kt={class:"max-w-[80px] truncate"},Ft=["onClick"],Jt={key:1,class:"text-xs text-gray-400"},qt={key:0,class:"px-3"},Wt={class:"flex items-center gap-2 p-2 bg-blue-50 border border-blue-200 rounded-lg"},Qt=["onKeydown"],Gt={key:1},Xt={class:"flex items-center gap-4"},Yt={class:"flex-1 min-w-0"},Zt={class:"flex items-center gap-2"},es={class:"text-xl font-semibold text-gray-900 truncate"},ts={key:0,class:"text-sm text-gray-600 mt-1 truncate"},ss={class:"flex items-center gap-2 flex-shrink-0"},os={key:0,class:"flex-1 overflow-hidden flex flex-col"},rs={key:0,class:"px-6 py-3 bg-gray-50 border-b"},ns={class:"flex items-center flex-wrap gap-4 text-sm text-gray-600"},ls={class:"flex items-center gap-1"},as={class:"flex items-center gap-1"},is={class:"flex items-center gap-1"},ds={class:"flex items-center gap-1"},cs={class:"flex items-center gap-1"},us={key:0,class:"w-4 h-4 text-yellow-500",fill:"currentColor",viewBox:"0 0 24 24"},ps={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ms={class:"flex items-center gap-2"},gs={class:"flex flex-wrap gap-1"},vs={key:0,class:"text-xs text-gray-500"},fs={class:"flex-1 overflow-hidden flex flex-col"},hs={class:"flex border-b"},xs=["onClick"],ys={class:"flex-1 overflow-y-auto p-6"},bs={key:0,class:"h-full"},ws={key:1,class:"h-full p-4 whitespace-pre-wrap text-sm text-gray-800 font-mono overflow-auto bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg border border-gray-200"},ks={key:1,class:"space-y-4"},_s={class:"space-y-3"},$s={class:"flex"},Cs={class:"text-sm text-gray-900"},js={class:"flex"},Ms={class:"text-sm text-gray-900"},Ss={class:"flex"},Vs={class:"text-sm text-gray-900"},zs={class:"flex"},Bs={class:"text-sm text-gray-900"},Ts={class:"flex"},Ls={class:"text-sm text-gray-900"},Es={class:"flex"},As={class:"text-sm text-gray-900"},Ds={class:"flex"},Hs={class:"text-sm text-gray-900"},Ps={class:"pt-3 border-t border-gray-200"},Is={class:"text-sm text-gray-900"},Ns={key:0,class:"p-3 bg-gray-50 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"},Rs={key:1,class:"text-gray-400 italic"},Us={class:"pt-3 border-t border-gray-200"},Os={class:"text-sm text-gray-900"},Ks={key:0,class:"p-3 bg-gray-50 rounded border border-gray-200 whitespace-pre-wrap font-mono text-xs"},Fs={key:1,class:"text-gray-400 italic"},Js={key:2,class:"h-full"},qs=K({__name:"PromptDetailModal",props:{prompt:{}},emits:["close","edit","optimize","rollback"],setup(A,{expose:w,emit:x}){const v=ee(),k="https://api.prompt-ui.xiechengqi.top",n=A,M=x,S=le(()=>!!n.prompt),z=g("content"),y=g(!1),T=g(""),_=g(""),f=g(""),$=g("system"),m=g(!1),s=g([]),o=g(""),l=g(!1),C=g(),B=g(!1),E=g(!1),U=le(()=>{if(!n.prompt)return[];const c=n.prompt.tags;return Array.isArray(c)?c:typeof c=="string"?c.split(",").map(t=>t.trim()).filter(t=>t):[]}),H=[{key:"content",label:"提示词内容"},{key:"info",label:"基本信息"},{key:"versions",label:"版本历史"}],W=()=>{y.value=!1,M("close"),z.value="content"},Q=()=>{if(!n.prompt)return;T.value=n.prompt.final_prompt,_.value=n.prompt.title,f.value=n.prompt.description||"",$.value=n.prompt.prompt_type||"system",m.value=!!n.prompt.is_public;const c=n.prompt.tags;s.value=Array.isArray(c)?[...c]:typeof c=="string"?c.split(",").map(t=>t.trim()).filter(t=>t):[],y.value=!0},se=()=>{y.value=!1,T.value="",_.value="",f.value="",$.value="system",m.value=!1,s.value=[],o.value="",l.value=!1},G=()=>{const c=o.value.trim();if(c){if(s.value.length>=5){v.warning("最多只能添加5个标签",2e3);return}if(s.value.includes(c)){v.warning("标签已存在",2e3),o.value="";return}if(c.length>8){v.warning("标签最多8个字符",2e3);return}s.value.push(c),o.value="",l.value=!1}},X=c=>{s.value.splice(c,1)};q(l,async c=>{var t;c&&(await pe(),(t=C.value)==null||t.focus())});const oe=async()=>{if(n.prompt)try{B.value=!0;const c=localStorage.getItem("yprompt_token");if(!c)throw new Error("请先登录");const t=await fetch(`${k}/api/prompts/${n.prompt.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:JSON.stringify({title:_.value.trim(),description:f.value.trim(),final_prompt:T.value,prompt_type:$.value,is_public:m.value?1:0,tags:s.value})});if(!t.ok){let h="保存失败";try{h=(await t.json()).message||h}catch{h=`保存失败: ${t.status} ${t.statusText}`}throw new Error(h)}const a=await t.json();if(a.code===200)v.success("保存成功",2e3),y.value=!1,n.prompt&&(n.prompt.title=_.value.trim(),n.prompt.description=f.value.trim(),n.prompt.final_prompt=T.value,n.prompt.prompt_type=$.value,n.prompt.is_public=m.value?1:0,n.prompt.tags=s.value),M("edit",n.prompt);else throw new Error(a.message||"保存失败")}catch(c){console.error("保存失败:",c),v.error(`保存失败: ${c.message}`,3e3)}finally{B.value=!1}},re=async()=>{if(n.prompt)try{await ve(n.prompt.final_prompt),v.success("提示词已复制到剪贴板",2e3)}catch(c){console.error("复制失败:",c),v.error("复制失败",2e3)}},F=c=>new Date(c).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),ne=()=>{E.value=!0};return q(()=>n.prompt,()=>{n.prompt&&E.value&&pe(()=>{Q(),E.value=!1})}),w({startEdit:ne}),(c,t)=>{var a,h,V,u;return S.value?(r(),i("div",jt,[e("div",Mt,[e("div",St,[e("div",Vt,[y.value?(r(),i("div",zt,[e("div",Bt,[e("div",Tt,[P(e("input",{"onUpdate:modelValue":t[0]||(t[0]=p=>_.value=p),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none text-xl font-semibold text-gray-900",placeholder:"请输入标题"},null,512),[[J,_.value]])]),e("div",Lt,[e("button",{onClick:se,class:"px-3 py-1.5 text-sm bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors flex items-center gap-1"},[...t[12]||(t[12]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),b(" 取消 ",-1)])]),e("button",{onClick:oe,disabled:B.value,class:"px-3 py-1.5 text-sm bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors flex items-center gap-1 disabled:opacity-50"},[B.value?j("",!0):(r(),i("svg",At,[...t[13]||(t[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"},null,-1)])])),b(" "+d(B.value?"保存中...":"保存"),1)],8,Et)])]),P(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=p=>f.value=p),class:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none text-sm text-gray-700 resize-none",rows:"2",placeholder:"请输入描述（可选）"},null,512),[[J,f.value]]),e("div",Dt,[e("div",Ht,[t[16]||(t[16]=e("span",{class:"text-xs font-medium text-gray-600"},"类型",-1)),e("div",Pt,[e("label",It,[P(e("input",{"onUpdate:modelValue":t[2]||(t[2]=p=>$.value=p),type:"radio",value:"system",class:"w-3.5 h-3.5 text-purple-600 border-gray-300 focus:ring-purple-500 focus:ring-1"},null,512),[[ce,$.value]]),t[14]||(t[14]=e("span",{class:"ml-1 text-xs text-gray-700 group-hover:text-purple-600"},"系统",-1))]),e("label",Nt,[P(e("input",{"onUpdate:modelValue":t[3]||(t[3]=p=>$.value=p),type:"radio",value:"user",class:"w-3.5 h-3.5 text-blue-600 border-gray-300 focus:ring-blue-500 focus:ring-1"},null,512),[[ce,$.value]]),t[15]||(t[15]=e("span",{class:"ml-1 text-xs text-gray-700 group-hover:text-blue-600"},"用户",-1))])])]),t[20]||(t[20]=e("div",{class:"w-px h-4 bg-gray-300"},null,-1)),e("label",Rt,[P(e("input",{"onUpdate:modelValue":t[4]||(t[4]=p=>m.value=p),type:"checkbox",class:"w-3.5 h-3.5 text-green-600 border-gray-300 rounded focus:ring-green-500 focus:ring-1"},null,512),[[he,m.value]]),t[17]||(t[17]=e("span",{class:"ml-1 text-xs text-gray-700 group-hover:text-green-600"},"公开",-1))]),t[21]||(t[21]=e("div",{class:"w-px h-4 bg-gray-300"},null,-1)),e("div",Ut,[t[19]||(t[19]=e("span",{class:"text-xs font-medium text-gray-600 flex-shrink-0"},"标签",-1)),e("div",Ot,[(r(!0),i(D,null,I(s.value,(p,O)=>(r(),i("span",{key:O,class:"inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-blue-100 text-blue-700 text-xs rounded hover:bg-blue-200 transition-colors"},[e("span",Kt,d(p),1),e("button",{onClick:Y=>X(O),class:"text-blue-600 hover:text-blue-800 font-bold text-sm leading-none",title:"移除标签"}," × ",8,Ft)]))),128)),s.value.length<5?(r(),i("button",{key:0,onClick:t[5]||(t[5]=p=>l.value=!l.value),class:"inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-gray-200 hover:bg-gray-300 text-gray-600 text-xs rounded transition-colors",title:"添加标签"},[...t[18]||(t[18]=[e("span",null,"+",-1)])])):(r(),i("span",Jt,"(最多5个)"))])])]),l.value?(r(),i("div",qt,[e("div",Wt,[P(e("input",{ref_key:"tagInputRef",ref:C,"onUpdate:modelValue":t[6]||(t[6]=p=>o.value=p),type:"text",placeholder:"输入标签名（最多8字）",maxlength:"8",class:"flex-1 px-2 py-1 border border-gray-300 rounded outline-none text-sm focus:border-blue-500 focus:ring-1 focus:ring-blue-500",onKeydown:[ue(L(G,["prevent"]),["enter"]),t[7]||(t[7]=ue(p=>l.value=!1,["esc"]))]},null,40,Qt),[[J,o.value]]),e("button",{onClick:G,class:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded transition-colors"}," 添加 "),e("button",{onClick:t[8]||(t[8]=p=>{l.value=!1,o.value=""}),class:"px-3 py-1 bg-gray-300 hover:bg-gray-400 text-gray-700 text-sm rounded transition-colors"}," 取消 ")])])):j("",!0)])):(r(),i("div",Gt,[e("div",Xt,[e("div",Yt,[e("div",Zt,[e("h2",es,d((a=c.prompt)==null?void 0:a.title),1),e("span",{class:ae([((h=c.prompt)==null?void 0:h.prompt_type)==="system"?"bg-purple-100 text-purple-700 border-purple-200":"bg-blue-100 text-blue-700 border-blue-200","px-2 py-0.5 text-xs font-medium rounded border flex-shrink-0"])},d(((V=c.prompt)==null?void 0:V.prompt_type)==="system"?"系统提示词":"用户提示词"),3)]),(u=c.prompt)!=null&&u.description?(r(),i("p",ts,d(c.prompt.description),1)):j("",!0)]),e("div",ss,[e("button",{onClick:re,class:"px-3 py-1.5 text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors flex items-center gap-1"},[...t[22]||(t[22]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),b(" 复制 ",-1)])]),e("button",{onClick:Q,"data-edit":"prompt-detail",class:"px-3 py-1.5 text-sm bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors flex items-center gap-1"},[...t[23]||(t[23]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),b(" 编辑 ",-1)])]),c.prompt?(r(),i("button",{key:0,onClick:t[9]||(t[9]=p=>c.$emit("optimize",c.prompt)),class:"px-3 py-1.5 text-sm bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors flex items-center gap-1"},[...t[24]||(t[24]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),b(" 优化 ",-1)])])):j("",!0)])])]))]),e("button",{onClick:W,class:"text-gray-400 hover:text-gray-600 ml-4"},[...t[25]||(t[25]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),c.prompt?(r(),i("div",os,[y.value?j("",!0):(r(),i("div",rs,[e("div",ns,[e("span",ls,[t[26]||(t[26]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),b(" "+d(c.prompt.is_public?"公开":"私有"),1)]),t[33]||(t[33]=e("span",{class:"w-px h-4 bg-gray-300"},null,-1)),e("span",as,[t[27]||(t[27]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)),b(" "+d(c.prompt.view_count||0),1)]),e("span",is,[t[28]||(t[28]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)),b(" "+d(c.prompt.use_count||0),1)]),e("span",ds,[t[29]||(t[29]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),b(" v"+d(c.prompt.current_version||"1.0.0"),1)]),e("span",cs,[c.prompt.is_favorite?(r(),i("svg",us,[...t[30]||(t[30]=[e("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"},null,-1)])])):(r(),i("svg",ps,[...t[31]||(t[31]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"},null,-1)])])),b(" "+d(c.prompt.is_favorite?"已收藏":"未收藏"),1)]),t[34]||(t[34]=e("span",{class:"w-px h-4 bg-gray-300"},null,-1)),e("div",ms,[t[32]||(t[32]=e("span",null,"标签:",-1)),e("div",gs,[(r(!0),i(D,null,I(U.value,p=>(r(),i("span",{key:p,class:"inline-block px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full"},d(p),1))),128)),U.value.length===0?(r(),i("span",vs,"暂无标签")):j("",!0)])])])])),e("div",fs,[e("div",hs,[(r(),i(D,null,I(H,p=>e("button",{key:p.key,onClick:O=>z.value=p.key,class:ae(["flex-1 px-4 py-3 text-sm font-medium transition-colors",z.value===p.key?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"])},d(p.label),11,xs)),64))]),e("div",ys,[z.value==="content"?(r(),i("div",bs,[y.value?P((r(),i("textarea",{key:0,"onUpdate:modelValue":t[10]||(t[10]=p=>T.value=p),class:"w-full h-full p-4 outline-none resize-none text-sm text-gray-800 font-mono bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg border border-gray-200",placeholder:"请输入提示词内容..."},null,512)),[[J,T.value]]):(r(),i("pre",ws,d(c.prompt.final_prompt),1))])):j("",!0),z.value==="info"?(r(),i("div",ks,[e("div",null,[e("dl",_s,[e("div",$s,[t[35]||(t[35]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"标题:",-1)),e("dd",Cs,d(c.prompt.title),1)]),e("div",js,[t[36]||(t[36]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"描述:",-1)),e("dd",Ms,d(c.prompt.description||"暂无描述"),1)]),e("div",Ss,[t[37]||(t[37]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"语言:",-1)),e("dd",Vs,d(c.prompt.language==="zh"?"中文":"英文"),1)]),e("div",zs,[t[38]||(t[38]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"格式:",-1)),e("dd",Bs,d(c.prompt.format),1)]),e("div",Ts,[t[39]||(t[39]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"字符数:",-1)),e("dd",Ls,d(c.prompt.final_prompt.length),1)]),e("div",Es,[t[40]||(t[40]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"创建时间:",-1)),e("dd",As,d(F(c.prompt.create_time)),1)]),e("div",Ds,[t[41]||(t[41]=e("dt",{class:"w-32 text-sm font-medium text-gray-600"},"更新时间:",-1)),e("dd",Hs,d(F(c.prompt.update_time)),1)]),c.prompt.prompt_type==="user"?(r(),i(D,{key:0},[e("div",Ps,[t[42]||(t[42]=e("dt",{class:"text-sm font-medium text-gray-600 mb-2"},"系统提示词:",-1)),e("dd",Is,[c.prompt.system_prompt?(r(),i("pre",Ns,d(c.prompt.system_prompt),1)):(r(),i("span",Rs,"未设置"))])]),e("div",Us,[t[43]||(t[43]=e("dt",{class:"text-sm font-medium text-gray-600 mb-2"},"对话上下文:",-1)),e("dd",Os,[c.prompt.conversation_history?(r(),i("pre",Ks,d(c.prompt.conversation_history),1)):(r(),i("span",Fs,"未设置"))])])],64)):j("",!0)])])])):j("",!0),z.value==="versions"?(r(),i("div",Js,[c.prompt?(r(),te(Ct,{key:0,"prompt-id":c.prompt.id,onRollback:t[11]||(t[11]=p=>M("rollback",p))},null,8,["prompt-id"])):j("",!0)])):j("",!0)])])])):j("",!0)])])):j("",!0)}}}),Ws={class:"bg-white rounded-lg max-w-3xl w-full max-h-[85vh] overflow-hidden flex flex-col"},Qs={class:"flex items-center justify-between p-6 border-b"},Gs={class:"text-sm text-gray-600 mt-1"},Xs={class:"flex-1 overflow-y-auto p-6"},Ys={key:0,class:"flex items-center justify-center h-32"},Zs={key:1,class:"flex flex-col items-center justify-center h-32 text-center"},eo={key:2,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},to=["onClick"],so={class:"flex items-start justify-between mb-3"},oo={class:"flex-1 min-w-0"},ro={class:"flex items-center gap-2 mb-2"},no={class:"text-base font-semibold text-gray-900"},lo={class:"text-xs text-gray-500"},ao={class:"text-sm text-gray-700 line-clamp-2"},io={class:"flex items-center justify-between text-xs text-gray-500 mb-3"},co={class:"flex items-center gap-4"},uo={class:"flex items-center gap-1"},po={class:"flex items-center gap-1"},mo={class:"flex items-center gap-2 pt-3 border-t border-gray-100"},go=["onClick"],vo=["onClick"],fo=K({__name:"VersionHistoryPanel",props:{isOpen:{type:Boolean},promptId:{}},emits:["close","rollback"],setup(A,{emit:w}){const x=A,v=w,k=ee(),n=g([]),M=g(!1),S=g(!1),z=g(null),y=async()=>{try{M.value=!0;const o=await R.getVersionList(x.promptId,1,10);if(o.code===200)n.value=o.data.items;else throw new Error(o.message||"加载失败")}catch(o){console.error("加载版本历史失败:",o),k.error(`加载失败: ${o.message}`)}finally{M.value=!1}},T=o=>{z.value=o,S.value=!0},_=async o=>{if(confirm(`确定要回滚到版本 v${o.version_number} 吗？`))try{const l=await R.rollbackToVersion(x.promptId,o.id,{change_summary:`回滚到版本 ${o.version_number}`});if(l.code===200)k.success(`成功回滚到版本 v${o.version_number}`),v("rollback",o.version_number),y(),$();else throw new Error(l.message||"回滚失败")}catch(l){console.error("回滚失败:",l),k.error(`回滚失败: ${l.message}`)}},f=async o=>{if(confirm(`确定要删除版本 v${o.version_number} 吗？此操作不可恢复。`))try{const l=await R.deleteVersion(x.promptId,o.id);if(l.code===200)k.success(`版本 v${o.version_number} 已删除`),y();else throw new Error(l.message||"删除失败")}catch(l){console.error("删除版本失败:",l),k.error(`删除失败: ${l.message}`)}},$=()=>{v("close")},m=o=>{const l=new Date(o),B=new Date().getTime()-l.getTime(),E=Math.floor(B/(1e3*60*60*24));return E===0?"今天 "+l.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):E===1?"昨天 "+l.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):E<7?`${E}天前`:l.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},s=o=>o<1024?`${o}B`:o<1024*1024?`${(o/1024).toFixed(1)}KB`:`${(o/(1024*1024)).toFixed(1)}MB`;return q(()=>x.isOpen,o=>{o&&y()}),(o,l)=>o.isOpen?(r(),i("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:L($,["self"])},[e("div",Ws,[e("div",Qs,[e("div",null,[l[1]||(l[1]=e("h2",{class:"text-xl font-bold text-gray-900 flex items-center gap-2"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),b(" 版本历史 ")],-1)),e("p",Gs,"共 "+d(n.value.length)+" 个版本",1)]),e("button",{onClick:$,class:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"关闭"},[...l[2]||(l[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Xs,[M.value?(r(),i("div",Ys,[...l[3]||(l[3]=[e("div",{class:"flex items-center gap-2 text-gray-500"},[e("div",{class:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e("span",null,"加载中...")],-1)])])):n.value.length===0?(r(),i("div",Zs,[...l[4]||(l[4]=[e("svg",{class:"w-12 h-12 mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"text-gray-600"},"暂无版本历史",-1)])])):(r(),i("div",eo,[(r(!0),i(D,null,I(n.value,C=>(r(),i("div",{key:C.id,onClick:B=>T(C),class:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer"},[e("div",so,[e("div",oo,[e("div",ro,[e("h3",no," v"+d(C.version_number),1),e("span",lo,d(m(C.create_time)),1)]),e("p",ao,d(C.change_summary||"无变更说明"),1)])]),e("div",io,[e("div",co,[e("span",uo,[l[5]||(l[5]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),b(" "+d(C.author_name),1)]),e("span",po,[l[6]||(l[6]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),b(" "+d(s(C.content_size)),1)])])]),e("div",mo,[e("button",{onClick:L(B=>_(C),["stop"]),class:"flex-1 px-3 py-1.5 text-sm bg-blue-100 hover:bg-blue-200 text-blue-700 rounded transition-colors flex items-center justify-center gap-1"},[...l[7]||(l[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),b(" 回滚到此版本 ",-1)])],8,go),e("button",{onClick:L(B=>f(C),["stop"]),class:"px-3 py-1.5 text-sm bg-red-100 hover:bg-red-200 text-red-700 rounded transition-colors flex items-center justify-center",title:"删除版本"},[...l[8]||(l[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,vo)])],8,to))),128))]))])]),S.value?(r(),te(fe,{key:0,version:z.value,"prompt-id":o.promptId,onClose:l[0]||(l[0]=C=>S.value=!1),onRollback:_},null,8,["version","prompt-id"])):j("",!0)])):j("",!0)}}),ho=de(fo,[["__scopeId","data-v-06688c15"]]),xo={class:"h-full flex flex-col"},yo={class:"flex-1 overflow-y-auto p-4"},bo={key:0,class:"flex items-center justify-center h-32"},wo={key:1,class:"flex flex-col items-center justify-center h-64 text-center"},ko={class:"text-lg font-semibold text-gray-800 mb-2"},_o={class:"text-gray-600 mb-4"},$o={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Co=["onClick"],jo={class:"flex items-start justify-between gap-3 mb-3"},Mo={class:"flex-1 min-w-0"},So={class:"text-base font-medium text-gray-900 truncate mb-1"},Vo={class:"text-sm text-gray-600 line-clamp-2 h-10"},zo={class:"text-sm text-gray-700 mb-3 p-3 bg-gradient-to-br from-gray-50 to-gray-100 rounded-md border border-gray-200"},Bo={class:"line-clamp-2 h-10 font-mono text-xs leading-relaxed"},To={key:0},Lo={key:1,class:"text-gray-400 italic"},Eo={class:"flex items-center justify-between pt-2 border-t border-gray-100"},Ao={class:"flex items-center gap-3 text-xs text-gray-500"},Do={class:"flex items-center gap-1"},Ho={class:"flex items-center gap-1"},Po={class:"flex items-center gap-1"},Io={class:"text-gray-400"},No={class:"flex items-center gap-1"},Ro=["onClick"],Uo={class:"relative group"},Oo=["onClick"],Ko=["onClick"],Fo=["onClick"],Jo=["onClick"],qo=["onClick"],Wo={class:"mt-3 pt-2 border-t border-gray-100"},Qo={class:"flex flex-wrap gap-1"},Go={key:0,class:"text-xs text-gray-400"},Xo={key:3,class:"flex justify-center items-center gap-2 mt-6"},Yo=["disabled"],Zo={class:"text-sm text-gray-600"},er=["disabled"],me=10,tr=K({__name:"PromptList",emits:["create-prompt"],setup(A,{expose:w,emit:x}){const v=xe("searchKeyword",g("")),k=ke(),n=ye(),M="https://api.prompt-ui.xiechengqi.top",S=g([]),z=g(!1),y=g(1),T=g(0),_=g(""),f=g("create_time"),$=g("0"),m=g([]);q(v,(t,a)=>{t!==a&&(y.value=1,H())},{immediate:!1});const s=t=>{v.value=t,y.value=1},o=g({}),l=g(!1),C=g(null),B=g(!1),E=g(null),U=le(()=>Math.ceil(T.value/me)),H=async()=>{try{z.value=!0;const t=localStorage.getItem("yprompt_token");if(!t)throw new Error("请先登录");const a=new URLSearchParams({page:y.value.toString(),limit:me.toString(),keyword:v.value,tag:_.value,sort:f.value,is_favorite:$.value}),h=await fetch(`${M}/api/prompts/?${a}`,{headers:{Authorization:`Bearer ${t}`}});if(!h.ok){let u="加载失败";try{u=(await h.json()).message||u}catch{u=`加载失败: ${h.status} ${h.statusText}`}throw new Error(u)}const V=await h.json();if(V.code===200){S.value=V.data.items.map(p=>({...p,final_prompt:p.final_prompt||"",current_version:p.current_version||"1.0.0"})),T.value=V.data.total;const u=new Set;S.value.forEach(p=>{p.tags&&(Array.isArray(p.tags)?p.tags:[]).forEach(Y=>u.add(Y))}),m.value=Array.from(u).sort()}else throw new Error(V.message||"加载失败")}catch(t){console.error("加载提示词列表失败:",t);const{useNotificationStore:a}=await N(async()=>{const{useNotificationStore:V}=await import("./index-CPHoan2D.js").then(u=>u.ae);return{useNotificationStore:V}},__vite__mapDeps([0,1]));a().error(`加载失败: ${t.message}`,3e3)}finally{z.value=!1}},W=t=>{y.value=t,H()},Q=async t=>{try{const a=localStorage.getItem("yprompt_token");if(!a)return;const h=await fetch(`${M}/api/prompts/${t.id}`,{headers:{Authorization:`Bearer ${a}`}});if(!h.ok){let u="获取详情失败";try{u=(await h.json()).message||u}catch{u=`获取详情失败: ${h.status} ${h.statusText}`}throw new Error(u)}const V=await h.json();V.code===200&&(C.value=V.data,l.value=!0)}catch(a){console.error("获取提示词详情失败:",a),C.value=t,l.value=!0}},se=t=>{C.value=t,l.value=!0,setTimeout(()=>{const a=document.querySelector('button[data-edit="prompt-detail"]');a&&a.click()},100)},G=t=>{const a=S.value.findIndex(h=>h.id===t.id);a!==-1&&(S.value[a]={...t}),l.value=!1},X=t=>{n.setCurrentModule("optimize"),k.push(`/optimize/${t.id}`),l.value=!1},oe=async t=>{try{await ve(t.final_prompt);const{useNotificationStore:a}=await N(async()=>{const{useNotificationStore:V}=await import("./index-CPHoan2D.js").then(u=>u.ae);return{useNotificationStore:V}},__vite__mapDeps([0,1]));a().success("提示词已复制到剪贴板",2e3)}catch(a){console.error("复制失败:",a);const{useNotificationStore:h}=await N(async()=>{const{useNotificationStore:u}=await import("./index-CPHoan2D.js").then(p=>p.ae);return{useNotificationStore:u}},__vite__mapDeps([0,1]));h().error("复制失败",2e3)}},re=t=>{E.value=t,B.value=!0,o.value={}},F=()=>{H()},ne=async t=>{if(confirm(`确定要删除提示词"${t.title}"吗？此操作不可恢复。`))try{const a=localStorage.getItem("yprompt_token");if(!a)return;const h=await fetch(`${M}/api/prompts/${t.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}});if(!h.ok){let u="删除失败";try{u=(await h.json()).message||u}catch{u=`删除失败: ${h.status} ${h.statusText}`}throw new Error(u)}const V=await h.json();if(V.code===200){const{useNotificationStore:u}=await N(async()=>{const{useNotificationStore:O}=await import("./index-CPHoan2D.js").then(Y=>Y.ae);return{useNotificationStore:O}},__vite__mapDeps([0,1]));u().success("删除成功",2e3),H()}else throw new Error(V.message||"删除失败")}catch(a){console.error("删除提示词失败:",a);const{useNotificationStore:h}=await N(async()=>{const{useNotificationStore:u}=await import("./index-CPHoan2D.js").then(p=>p.ae);return{useNotificationStore:u}},__vite__mapDeps([0,1]));h().error(`删除失败: ${a.message}`,3e3)}},c=t=>new Date(t).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return document.addEventListener("click",t=>{t.target.closest(".relative.group")||(o.value={})}),w({searchWithKeyword:s,loadPrompts:H}),ge(()=>{H()}),(t,a)=>{var V;const h=be("router-link");return r(),i("div",xo,[e("div",yo,[z.value?(r(),i("div",bo,[...a[5]||(a[5]=[e("div",{class:"flex items-center gap-2 text-gray-500"},[e("div",{class:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e("span",null,"加载中...")],-1)])])):S.value.length===0?(r(),i("div",wo,[a[7]||(a[7]=e("svg",{class:"w-16 h-16 mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("h3",ko,d(ie(v)||_.value?"没有找到匹配的提示词":"还没有保存的提示词"),1),e("p",_o,d(ie(v)||_.value?"请尝试其他搜索条件":"去生成页面创建您的第一个提示词吧！"),1),Z(h,{to:"/generate",class:"inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},{default:we(()=>[...a[6]||(a[6]=[b(" 开始生成 ",-1)])]),_:1})])):(r(),i("div",$o,[(r(!0),i(D,null,I(S.value,u=>(r(),i("div",{key:u.id,class:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:p=>Q(u)},[e("div",jo,[e("div",Mo,[e("h3",So,d(u.title),1),e("p",Vo,d(u.description||"暂无描述"),1)]),e("span",{class:ae([u.prompt_type==="system"?"bg-purple-100 text-purple-700 border-purple-200":"bg-blue-100 text-blue-700 border-blue-200","px-2 py-0.5 text-xs font-medium rounded border flex-shrink-0"])},d(u.prompt_type==="system"?"系统":"用户"),3)]),e("div",zo,[e("div",Bo,[u.final_prompt?(r(),i("span",To,d(u.final_prompt.slice(0,150))+d(u.final_prompt.length>150?"...":""),1)):(r(),i("span",Lo," 暂无提示词内容 "))])]),e("div",Eo,[e("div",Ao,[e("span",Do,[a[8]||(a[8]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)),b(" "+d(u.view_count||0),1)]),e("span",Ho,[a[9]||(a[9]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)),b(" "+d(u.use_count||0),1)]),e("span",Po,[a[10]||(a[10]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),b(" v"+d(u.current_version||"1.0.0"),1)]),e("span",Io," • "+d(c(u.update_time||u.create_time)),1)]),e("div",No,[e("button",{onClick:L(p=>oe(u),["stop"]),class:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",title:"复制"},[...a[11]||(a[11]=[e("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])],8,Ro),e("div",Uo,[e("button",{onClick:L(p=>o.value[u.id]=!o.value[u.id],["stop"]),class:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",title:"更多操作"},[...a[12]||(a[12]=[e("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})],-1)])],8,Oo),o.value[u.id]?(r(),i("div",{key:0,onClick:a[0]||(a[0]=L(()=>{},["stop"])),class:"absolute right-0 top-full mt-1 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-10"},[e("button",{onClick:L(p=>se(u),["stop"]),class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 transition-colors flex items-center gap-2"},[...a[13]||(a[13]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),b(" 编辑 ",-1)])],8,Ko),e("button",{onClick:L(p=>X(u),["stop"]),class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 transition-colors flex items-center gap-2"},[...a[14]||(a[14]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),b(" 优化 ",-1)])],8,Fo),e("button",{onClick:L(p=>re(u),["stop"]),class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 transition-colors flex items-center gap-2"},[...a[15]||(a[15]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),b(" 版本历史 ",-1)])],8,Jo),e("button",{onClick:L(p=>ne(u),["stop"]),class:"w-full text-left px-3 py-2 text-sm hover:bg-red-50 text-red-600 transition-colors flex items-center gap-2"},[...a[16]||(a[16]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),b(" 删除 ",-1)])],8,qo)])):j("",!0)])])]),e("div",Wo,[e("div",Qo,[(r(!0),i(D,null,I(u.tags||[],p=>(r(),i("span",{key:p,class:"inline-block px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-md"},d(p),1))),128)),!u.tags||u.tags.length===0?(r(),i("span",Go," 暂无标签 ")):j("",!0)])])],8,Co))),128))])),U.value>1?(r(),i("div",Xo,[e("button",{onClick:a[1]||(a[1]=u=>W(y.value-1)),disabled:y.value<=1,class:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," 上一页 ",8,Yo),e("span",Zo," 第 "+d(y.value)+" 页，共 "+d(U.value)+" 页 ",1),e("button",{onClick:a[2]||(a[2]=u=>W(y.value+1)),disabled:y.value>=U.value,class:"px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," 下一页 ",8,er)])):j("",!0)]),l.value?(r(),te(qs,{key:0,prompt:C.value,onClose:a[3]||(a[3]=u=>l.value=!1),onEdit:G,onOptimize:X,onRollback:F},null,8,["prompt"])):j("",!0),Z(ho,{"is-open":B.value,"prompt-id":((V=E.value)==null?void 0:V.id)||0,onClose:a[4]||(a[4]=u=>B.value=!1),onRollback:F},null,8,["is-open","prompt-id"])])}}}),sr=de(tr,[["__scopeId","data-v-69046943"]]),or={class:"h-full flex flex-col overflow-hidden p-2"},rr={class:"bg-white rounded-lg shadow-sm p-6 mb-4 flex-shrink-0"},nr={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6"},lr={class:"flex flex-col sm:flex-row items-stretch sm:items-center gap-4"},ar={class:"relative"},ir={class:"flex items-center gap-3"},dr={class:"flex-1 bg-white rounded-lg shadow-sm overflow-hidden"},cr={key:0,class:"h-full flex flex-col"},ur={key:1,class:"h-full flex items-center justify-center"},gr=K({__name:"LibraryModule",setup(A){const w=_e(),x="https://api.prompt-ui.xiechengqi.top",v=g(!1),k=g(""),n=g(!1),M=g(""),S=g();let z=null;Ce("searchKeyword",M);const y=()=>{z&&clearTimeout(z),z=setTimeout(()=>{S.value&&S.value.searchWithKeyword(M.value)},500)},T=async _=>{try{n.value=!0;const f=localStorage.getItem("yprompt_token");if(!f)throw new Error("请先登录");const m=await(await fetch(`${x}/api/prompts/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({title:_.title,description:_.description,final_prompt:_.content||k.value,language:"zh",format:"markdown",prompt_type:_.promptType,tags:_.tags,is_public:_.isPublic?1:0})})).json();if(m.code===200){const{useNotificationStore:s}=await N(async()=>{const{useNotificationStore:l}=await import("./index-CPHoan2D.js").then(C=>C.ae);return{useNotificationStore:l}},__vite__mapDeps([0,1]));s().success("提示词创建成功！",2e3),v.value=!1,k.value="",S.value&&await S.value.loadPrompts()}else throw new Error(m.message||"创建失败")}catch(f){console.error("创建提示词失败:",f);const{useNotificationStore:$}=await N(async()=>{const{useNotificationStore:s}=await import("./index-CPHoan2D.js").then(o=>o.ae);return{useNotificationStore:s}},__vite__mapDeps([0,1]));$().error(`创建失败: ${f.message}`,3e3)}finally{n.value=!1}};return(_,f)=>(r(),i("div",or,[e("div",rr,[e("div",nr,[f[6]||(f[6]=e("div",{class:"min-w-0"},[e("h2",{class:"text-xl lg:text-2xl font-bold text-gray-900"},"模板库"),e("p",{class:"text-sm text-gray-500 mt-1"},"管理和使用您的提示词模板")],-1)),e("div",lr,[e("div",ar,[f[4]||(f[4]=e("span",{class:"absolute left-3.5 top-2.5 text-gray-400"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),P(e("input",{"onUpdate:modelValue":f[0]||(f[0]=$=>M.value=$),type:"text",placeholder:"搜索提示词...",class:"w-80 pl-11 pr-4 py-2.5 border border-gray-300 rounded-lg text-sm outline-none",onInput:y},null,544),[[J,M.value]])]),e("div",ir,[e("button",{onClick:f[1]||(f[1]=$=>v.value=!0),class:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center gap-2 whitespace-nowrap text-sm font-medium"},[...f[5]||(f[5]=[e("span",null,"新建提示词",-1)])])])])])]),e("div",dr,[ie(w).isLoggedIn?(r(),i("div",cr,[Z(sr,{ref_key:"promptListRef",ref:S,onCreatePrompt:f[2]||(f[2]=$=>v.value=!0)},null,512),Z(je,{"is-open":v.value,"prompt-content":k.value,"is-saving":n.value,onSave:T,onCancel:f[3]||(f[3]=$=>v.value=!1)},null,8,["is-open","prompt-content","is-saving"])])):(r(),i("div",ur,[...f[7]||(f[7]=[$e('<div class="text-center max-w-md px-6"><svg class="w-16 h-16 mb-4 text-gray-400 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg><h4 class="text-2xl font-bold text-gray-800 mb-2">请先登录</h4><p class="text-gray-600"> 登录后即可访问您的个人提示词库 </p></div>',1)])]))])]))}});export{gr as default};
