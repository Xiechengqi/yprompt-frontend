import{d as P,r as h,A as V,e as d,h as M,f as t,w as D,j as u,J as f,v as x,t as b,V as C,F as U,y as B,O as R,p as j,s as p}from"./index-BqlgnoXa.js";async function z(c){if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(c);return}catch(y){console.warn("Clipboard API 失败，尝试降级方案:",y)}return A(c)}function A(c){return new Promise((y,n)=>{const r=document.createElement("textarea");if(r.value=c,r.style.position="fixed",r.style.top="0",r.style.left="0",r.style.width="2em",r.style.height="2em",r.style.padding="0",r.style.border="none",r.style.outline="none",r.style.boxShadow="none",r.style.background="transparent",r.style.opacity="0",document.body.appendChild(r),r.focus(),r.select(),navigator.userAgent.match(/ipad|ipod|iphone/i)){const l=document.createRange();l.selectNodeContents(r);const a=window.getSelection();a&&(a.removeAllRanges(),a.addRange(l)),r.setSelectionRange(0,999999)}try{const l=document.execCommand("copy");document.body.removeChild(r),l?y():n(new Error('execCommand("copy") 返回 false'))}catch(l){document.body.removeChild(r),n(l)}})}const ee=Object.freeze(Object.defineProperty({__proto__:null,copyToClipboard:z},Symbol.toStringTag,{value:"Module"})),O={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},L={class:"p-6 space-y-4"},N={class:"mt-1 text-xs text-gray-500"},E={class:"mt-1 text-xs text-gray-500"},F={class:"flex gap-4"},$={class:"flex items-center cursor-pointer"},I={class:"flex items-center cursor-pointer"},K={class:"flex flex-wrap gap-2 mb-2"},W=["onClick"],H={class:"flex gap-2"},J={class:"flex items-center"},q={key:0,class:"p-3 bg-gray-50 border border-gray-200 rounded-lg max-h-40 overflow-y-auto text-sm text-gray-600"},G={class:"mt-1 text-xs text-gray-500"},Q={class:"flex justify-end gap-3 p-6 border-t bg-gray-50"},X=["disabled"],Y={key:0,class:"flex items-center"},Z={key:1},te=P({__name:"SavePromptDialog",props:{isOpen:{type:Boolean},promptContent:{},isSaving:{type:Boolean},initialTitle:{}},emits:["save","cancel"],setup(c,{emit:y}){const n=c,r=y,l=h({title:"",description:"",tags:[],isPublic:!1,promptType:"system",content:""}),a=h(""),k=s=>{if(!s.trim())return`提示词_${new Date().toLocaleDateString()}`;let e="";if(s.trim().startsWith("<")){const o=s.match(/<title[^>]*>(.*?)<\/title>/i);if(o&&o[1]&&(e=o[1].trim(),e=e.replace(/^Role:\s*/i,"").trim()),!e){const i=[/<\w+\s+title=["']role["'][^>]*>([^<]+)/i,/<\w+\s+name=["']role["'][^>]*>([^<]+)/i,/<\w+\s+id=["']role["'][^>]*>([^<]+)/i,/<\w+\s+type=["']role["'][^>]*>([^<]+)/i,/<section[^>]*>[\s\n]*role:?\s*([^<]+)/i,/<role[^>]*>([^<]+)/i];for(const m of i){const g=s.match(m);if(g&&g[1]&&(e=g[1].trim(),e=e.replace(/^(role|角色)[:：]\s*/i,"").trim(),e))break}}if(!e){const i=s.match(/>([^<]+)</g);i&&i[0]&&(e=i[0].replace(/>/g,"").replace(/</g,"").trim())}}else{const o=s.trim().split(`
`);for(const i of o){const m=i.trim();if(m){if(m.startsWith("# Role:")){const g=m.substring(8).trim();if(g){e=g;break}}else if(e=m.replace(/^#{1,6}\s*/,"").replace(/^\*+\s*/,"").replace(/^-+\s*/,"").replace(/^\d+\.\s*/,"").trim(),e)break}}}return e||(e=`提示词_${new Date().toLocaleDateString()}`),e.length>50&&(e=e.substring(0,50)+"..."),e};V(()=>n.isOpen,s=>{s&&(n.initialTitle?l.value.title=n.initialTitle:l.value.title=k(n.promptContent||""),l.value.description="",l.value.tags=[],l.value.isPublic=!1,l.value.promptType="system",l.value.content="")});const v=()=>{const s=a.value.trim();s&&!l.value.tags.includes(s)&&l.value.tags.length<10&&(l.value.tags.push(s),a.value="")},T=s=>{l.value.tags=l.value.tags.filter(e=>e!==s)},S=()=>{if(l.value.title.trim()){if(!n.promptContent&&!l.value.content.trim()){alert("请输入提示词内容");return}r("save",{title:l.value.title.trim(),description:l.value.description.trim(),tags:l.value.tags,isPublic:l.value.isPublic,promptType:l.value.promptType,content:l.value.content.trim()})}},w=()=>{r("cancel")};return(s,e)=>s.isOpen?(p(),d("div",O,[t("div",{class:"bg-white rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",onClick:e[7]||(e[7]=D(()=>{},["stop"]))},[t("div",{class:"flex items-center justify-between p-6 border-b"},[e[9]||(e[9]=t("h2",{class:"text-xl font-semibold text-gray-900"},"保存提示词",-1)),t("button",{onClick:w,class:"text-gray-400 hover:text-gray-600"},[...e[8]||(e[8]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",L,[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[f(" 标题 "),t("span",{class:"text-red-500"},"*")],-1)),u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.title=o),type:"text",placeholder:"请输入提示词标题",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",maxlength:"200"},null,512),[[x,l.value.title]]),t("p",N,b(l.value.title.length)+"/200",1)]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," 描述 ",-1)),u(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.description=o),placeholder:"简短描述这个提示词的用途（可选）",rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",maxlength:"500"},null,512),[[x,l.value.description]]),t("p",E,b(l.value.description.length)+"/500",1)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[f(" 提示词类型 "),t("span",{class:"text-red-500"},"*")],-1)),t("div",F,[t("label",$,[u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.promptType=o),type:"radio",value:"system",class:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"},null,512),[[C,l.value.promptType]]),e[12]||(e[12]=t("span",{class:"ml-2 text-sm text-gray-700"},"系统提示词",-1))]),t("label",I,[u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.promptType=o),type:"radio",value:"user",class:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"},null,512),[[C,l.value.promptType]]),e[13]||(e[13]=t("span",{class:"ml-2 text-sm text-gray-700"},"用户提示词",-1))])]),e[15]||(e[15]=t("p",{class:"mt-1 text-xs text-gray-500"}," 系统提示词：用于定义AI的角色和行为规则；用户提示词：用于具体任务和指令 ",-1))]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," 标签 ",-1)),t("div",K,[(p(!0),d(U,null,B(l.value.tags,o=>(p(),d("span",{key:o,class:"inline-flex items-center px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm"},[f(b(o)+" ",1),t("button",{onClick:i=>T(o),class:"ml-2 text-blue-500 hover:text-blue-700"},"×",8,W)]))),128))]),t("div",H,[u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>a.value=o),type:"text",placeholder:"输入标签后按回车添加",onKeyup:R(v,["enter"]),class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,544),[[x,a.value]]),t("button",{onClick:v,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200"}," 添加 ")])]),t("div",J,[u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>l.value.isPublic=o),type:"checkbox",id:"isPublic",class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[j,l.value.isPublic]]),e[17]||(e[17]=t("label",{for:"isPublic",class:"ml-2 text-sm text-gray-700"}," 公开分享（其他用户可以看到） ",-1))]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[f(" 提示词内容 "),t("span",{class:"text-red-500"},"*")],-1)),s.promptContent&&s.promptContent.trim()?(p(),d("div",q,b(s.promptContent.slice(0,200))+b(s.promptContent.length>200?"...":""),1)):u((p(),d("textarea",{key:1,"onUpdate:modelValue":e[6]||(e[6]=o=>l.value.content=o),placeholder:"请输入或粘贴提示词内容...",rows:"8",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-sm"},null,512)),[[x,l.value.content]]),t("p",G,"共 "+b((s.promptContent||l.value.content).length)+" 个字符",1)])]),t("div",Q,[t("button",{onClick:w,class:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50"}," 取消 "),t("button",{onClick:S,disabled:!l.value.title.trim()||s.isSaving,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center"},[s.isSaving?(p(),d("span",Y,[...e[19]||(e[19]=[t("svg",{class:"w-4 h-4 mr-2 animate-spin",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),f(" 保存中... ",-1)])])):(p(),d("span",Z,"保存"))],8,X)])])])):M("",!0)}});export{te as _,ee as a,z as c};
