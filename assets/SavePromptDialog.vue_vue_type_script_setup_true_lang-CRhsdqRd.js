import{d as V,I as M,r as C,D,b as i,f as U,e as t,w as B,h as d,Q as y,a2 as v,t as g,a8 as k,F as R,y as z,a4 as j,k as A,p as u}from"./index-CPHoan2D.js";async function L(p){if(navigator.clipboard&&window.isSecureContext)try{await navigator.clipboard.writeText(p);return}catch(b){console.warn("Clipboard API 失败，尝试降级方案:",b)}return N(p)}function N(p){return new Promise((b,f)=>{const s=document.createElement("textarea");if(s.value=p,s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.width="2em",s.style.height="2em",s.style.padding="0",s.style.border="none",s.style.outline="none",s.style.boxShadow="none",s.style.background="transparent",s.style.opacity="0",document.body.appendChild(s),s.focus(),s.select(),navigator.userAgent.match(/ipad|ipod|iphone/i)){const n=document.createRange();n.selectNodeContents(s);const l=window.getSelection();l&&(l.removeAllRanges(),l.addRange(n)),s.setSelectionRange(0,999999)}try{const n=document.execCommand("copy");document.body.removeChild(s),n?b():f(new Error('execCommand("copy") 返回 false'))}catch(n){document.body.removeChild(s),f(n)}})}const le=Object.freeze(Object.defineProperty({__proto__:null,copyToClipboard:L},Symbol.toStringTag,{value:"Module"})),O={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},E={class:"p-6 space-y-4"},F={class:"mt-1 text-xs text-gray-500"},I={class:"mt-1 text-xs text-gray-500"},$={class:"flex gap-4"},K={class:"flex items-center cursor-pointer"},W={class:"flex items-center cursor-pointer"},H={class:"flex flex-wrap gap-2 mb-2"},Q=["onClick"],q={class:"flex gap-2"},G={class:"flex items-center"},J={key:0,class:"p-3 bg-gray-50 border border-gray-200 rounded-lg max-h-40 overflow-y-auto text-sm text-gray-600"},X={class:"mt-1 text-xs text-gray-500"},Y={class:"flex justify-end gap-3 p-6 border-t bg-gray-50"},Z=["disabled"],_={key:0,class:"flex items-center"},ee={key:1},se=V({__name:"SavePromptDialog",props:{isOpen:{type:Boolean},promptContent:{},isSaving:{type:Boolean},initialTitle:{}},emits:["save","cancel"],setup(p,{emit:b}){const f=M(),s=p,n=b,l=C({title:"",description:"",tags:[],isPublic:!1,promptType:"system",content:""}),x=C(""),T=o=>{if(!o.trim())return`提示词_${new Date().toLocaleDateString()}`;let e="";if(o.trim().startsWith("<")){const r=o.match(/<title[^>]*>(.*?)<\/title>/i);if(r&&r[1]&&(e=r[1].trim(),e=e.replace(/^Role:\s*/i,"").trim()),!e){const a=[/<\w+\s+title=["']role["'][^>]*>([^<]+)/i,/<\w+\s+name=["']role["'][^>]*>([^<]+)/i,/<\w+\s+id=["']role["'][^>]*>([^<]+)/i,/<\w+\s+type=["']role["'][^>]*>([^<]+)/i,/<section[^>]*>[\s\n]*role:?\s*([^<]+)/i,/<role[^>]*>([^<]+)/i];for(const c of a){const m=o.match(c);if(m&&m[1]&&(e=m[1].trim(),e=e.replace(/^(role|角色)[:：]\s*/i,"").trim(),e))break}}if(!e){const a=o.match(/>([^<]+)</g);a&&a[0]&&(e=a[0].replace(/>/g,"").replace(/</g,"").trim())}}else{const r=o.trim().split(`
`);for(const a of r){const c=a.trim();if(c){if(c.startsWith("# Role:")){const m=c.substring(8).trim();if(m){e=m;break}}else if(e=c.replace(/^#{1,6}\s*/,"").replace(/^\*+\s*/,"").replace(/^-+\s*/,"").replace(/^\d+\.\s*/,"").trim(),e)break}}}return e||(e=`提示词_${new Date().toLocaleDateString()}`),e.length>50&&(e=e.substring(0,50)+"..."),e};D(()=>s.isOpen,o=>{o&&(s.initialTitle?l.value.title=s.initialTitle:l.value.title=T(s.promptContent||""),l.value.description="",l.value.tags=[],l.value.isPublic=!1,l.value.promptType="system",l.value.content="")});const w=()=>{const o=x.value.trim();o&&!l.value.tags.includes(o)&&l.value.tags.length<10&&(l.value.tags.push(o),x.value="")},S=o=>{l.value.tags=l.value.tags.filter(e=>e!==o)},P=()=>{if(l.value.title.trim()){if(!s.promptContent&&!l.value.content.trim()){f.warning("请输入提示词内容",2e3);return}n("save",{title:l.value.title.trim(),description:l.value.description.trim(),tags:l.value.tags,isPublic:l.value.isPublic,promptType:l.value.promptType,content:l.value.content.trim()})}},h=()=>{n("cancel")};return(o,e)=>o.isOpen?(u(),i("div",O,[t("div",{class:"bg-white rounded-lg shadow-xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto",onClick:e[7]||(e[7]=B(()=>{},["stop"]))},[t("div",{class:"flex items-center justify-between p-6 border-b"},[e[9]||(e[9]=t("h2",{class:"text-xl font-semibold text-gray-900"},"保存提示词",-1)),t("button",{onClick:h,class:"text-gray-400 hover:text-gray-600"},[...e[8]||(e[8]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",E,[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[y(" 标题 "),t("span",{class:"text-red-500"},"*")],-1)),d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>l.value.title=r),type:"text",placeholder:"请输入提示词标题",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",maxlength:"200"},null,512),[[v,l.value.title]]),t("p",F,g(l.value.title.length)+"/200",1)]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," 描述 ",-1)),d(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=r=>l.value.description=r),placeholder:"简短描述这个提示词的用途（可选）",rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",maxlength:"500"},null,512),[[v,l.value.description]]),t("p",I,g(l.value.description.length)+"/500",1)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[y(" 提示词类型 "),t("span",{class:"text-red-500"},"*")],-1)),t("div",$,[t("label",K,[d(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>l.value.promptType=r),type:"radio",value:"system",class:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"},null,512),[[k,l.value.promptType]]),e[12]||(e[12]=t("span",{class:"ml-2 text-sm text-gray-700"},"系统提示词",-1))]),t("label",W,[d(t("input",{"onUpdate:modelValue":e[3]||(e[3]=r=>l.value.promptType=r),type:"radio",value:"user",class:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"},null,512),[[k,l.value.promptType]]),e[13]||(e[13]=t("span",{class:"ml-2 text-sm text-gray-700"},"用户提示词",-1))])]),e[15]||(e[15]=t("p",{class:"mt-1 text-xs text-gray-500"}," 系统提示词：用于定义AI的角色和行为规则；用户提示词：用于具体任务和指令 ",-1))]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," 标签 ",-1)),t("div",H,[(u(!0),i(R,null,z(l.value.tags,r=>(u(),i("span",{key:r,class:"inline-flex items-center px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm"},[y(g(r)+" ",1),t("button",{onClick:a=>S(r),class:"ml-2 text-blue-500 hover:text-blue-700"},"×",8,Q)]))),128))]),t("div",q,[d(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>x.value=r),type:"text",placeholder:"输入标签后按回车添加",onKeyup:j(w,["enter"]),class:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,544),[[v,x.value]]),t("button",{onClick:w,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200"}," 添加 ")])]),t("div",G,[d(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>l.value.isPublic=r),type:"checkbox",id:"isPublic",class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[A,l.value.isPublic]]),e[17]||(e[17]=t("label",{for:"isPublic",class:"ml-2 text-sm text-gray-700"}," 公开分享（其他用户可以看到） ",-1))]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[y(" 提示词内容 "),t("span",{class:"text-red-500"},"*")],-1)),o.promptContent&&o.promptContent.trim()?(u(),i("div",J,g(o.promptContent.slice(0,200))+g(o.promptContent.length>200?"...":""),1)):d((u(),i("textarea",{key:1,"onUpdate:modelValue":e[6]||(e[6]=r=>l.value.content=r),placeholder:"请输入或粘贴提示词内容...",rows:"8",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-sm"},null,512)),[[v,l.value.content]]),t("p",X,"共 "+g((o.promptContent||l.value.content).length)+" 个字符",1)])]),t("div",Y,[t("button",{onClick:h,class:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50"}," 取消 "),t("button",{onClick:P,disabled:!l.value.title.trim()||o.isSaving,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center"},[o.isSaving?(u(),i("span",_,[...e[19]||(e[19]=[t("svg",{class:"w-4 h-4 mr-2 animate-spin",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),y(" 保存中... ",-1)])])):(u(),i("span",ee,"保存"))],8,Z)])])])):U("",!0)}});export{se as _,le as a,L as c};
