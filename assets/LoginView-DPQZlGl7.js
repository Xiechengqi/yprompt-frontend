import{c as C,d as P,u as A,a as w,r as n,o as B,b as R,e as l,f as s,g as c,w as j,h as k,i as M,v as F,n as N,j as f,k as g,t as x,l as O,m as $,T as q,p as T,q as t,C as U,L as Y,_ as W}from"./index-CgStLW2f.js";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=C("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=C("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),J={class:"login-container"},K={class:"login-card"},Q={class:"login-header"},X={key:0,class:"debug-badge"},Z={key:0,class:"loading-state"},ee={key:1,class:"login-content"},se={key:0,class:"login-section"},oe={class:"form-group"},te={class:"input-wrapper"},ae=["type","disabled"],le=["disabled"],re={key:0,class:"field-error"},ne={class:"form-options"},ie={class:"checkbox-label"},de=["disabled"],ue={key:0,class:"error-message"},ce=["disabled"],pe={key:1},ve={key:2},me=P({__name:"LoginView",setup(ge){const p=R(),b=A(),L=w(()=>T()),y=n({local_auth_enabled:!0}),i=n({password:""}),_=n(!0),r=n(!1),d=n(""),v=n(!1),m=n(!0),a=n({}),I=o=>o?null:"è¯·è¾“å…¥å¯†ç ",h=()=>{a.value={};const o=I(i.value.password);return o&&(a.value.password=o),Object.keys(a.value).length===0},S=o=>{a.value[o]&&delete a.value[o]},V=w(()=>i.value.password.length>0&&Object.keys(a.value).length===0),E=async()=>{try{const o=await b.getAuthConfig();o&&(y.value=o)}catch(o){console.error("èŽ·å–è®¤è¯é…ç½®å¤±è´¥:",o)}finally{_.value=!1}},z=()=>{m.value?localStorage.setItem("yprompt_remember_me","true"):localStorage.removeItem("yprompt_remember_me")},D=async()=>{if(h()){d.value="",r.value=!0;try{const o=await b.loginWithPassword("admin",i.value.password);if(o.success){z();const e=p.currentRoute.value.query.redirect;e&&e!=="/login"?p.push(e):p.push("/")}else d.value=o.message||"å¯†ç é”™è¯¯"}catch(o){d.value=o instanceof Error?o.message:"ç™»å½•å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•",console.error("ç™»å½•å¤±è´¥:",o)}finally{r.value=!1}}};return B(()=>{if(b.isLoggedIn){p.push("/");return}localStorage.getItem("yprompt_remember_me")==="true"&&(m.value=!0),E()}),(o,e)=>(t(),l("div",J,[s("div",K,[s("div",Q,[e[5]||(e[5]=s("div",{class:"logo-wrapper"},[s("div",{class:"logo-icon"},"YP")],-1)),e[6]||(e[6]=s("h1",{class:"login-title"},"YPrompt",-1)),e[7]||(e[7]=s("p",{class:"login-subtitle"},"æç¤ºè¯ç®¡ç†ç³»ç»Ÿ",-1)),L.value?(t(),l("div",X,[...e[4]||(e[4]=[s("span",{class:"debug-icon"},"ðŸ›",-1),s("span",null,"Debug æ¨¡å¼ï¼ˆMock APIï¼‰",-1)])])):c("",!0)]),_.value?(t(),l("div",Z,[...e[8]||(e[8]=[s("div",{class:"loading-spinner"},null,-1),s("p",{class:"loading-text"},"æ­£åœ¨åŠ è½½...",-1)])])):(t(),l("div",ee,[y.value.local_auth_enabled?(t(),l("div",se,[s("form",{onSubmit:j(D,["prevent"]),class:"login-form"},[s("div",oe,[e[9]||(e[9]=s("label",{for:"password"},"å¯†ç ",-1)),s("div",te,[M(s("input",{id:"password","onUpdate:modelValue":e[0]||(e[0]=u=>i.value.password=u),type:v.value?"text":"password",class:N(["form-input",{"input-error":a.value.password}]),placeholder:"è¯·è¾“å…¥å¯†ç ",disabled:r.value,autocomplete:"current-password",onBlur:h,onInput:e[1]||(e[1]=u=>S("password"))},null,42,ae),[[F,i.value.password]]),s("button",{type:"button",class:"password-toggle",onClick:e[2]||(e[2]=u=>v.value=!v.value),disabled:r.value,tabindex:"-1"},[v.value?(t(),f(g(G),{key:1,size:18})):(t(),f(g(H),{key:0,size:18}))],8,le)]),a.value.password?(t(),l("div",re,x(a.value.password),1)):c("",!0)]),s("div",ne,[s("label",ie,[M(s("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=u=>m.value=u),class:"checkbox-input",disabled:r.value},null,8,de),[[O,m.value]]),e[10]||(e[10]=s("span",null,"è®°ä½æˆ‘",-1))])]),k(q,{name:"fade"},{default:$(()=>[d.value?(t(),l("div",ue,[k(g(U),{size:16}),s("span",null,x(d.value),1)])):c("",!0)]),_:1}),s("button",{type:"submit",class:"btn btn-primary btn-block",disabled:r.value||!V.value},[r.value?(t(),f(g(Y),{key:0,size:18,class:"spinning"})):c("",!0),r.value?(t(),l("span",pe,"ç™»å½•ä¸­...")):(t(),l("span",ve,"ç™»å½•"))],8,ce)],32)])):c("",!0)]))])]))}}),fe=W(me,[["__scopeId","data-v-a449e4e3"]]);export{fe as default};
